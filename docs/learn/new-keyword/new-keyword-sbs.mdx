---
title: Ключевое слово New
sidebarTitle: Пошаговое руководство
description: Научитесь создавать контракт, который создает другие контракты.
hide_table_of_contents: false
---

Вы видели ключевое слово `new` и использовали его для создания (инстанцирования) массивов в `memory` с размером, основанным на переменной. Вы также можете использовать его для написания контракта, который [creates other contracts].

---

## Цели

К концу этого урока вы сможете:

- Написать контракт, который создает новый контракт с помощью ключевого слова new

---

## Создание простой фабрики контрактов

Фабрика контрактов - это контракт, который создает другие контракты. Для начала давайте создадим и протестируем очень простую. Создайте новый проект в Remix и добавьте файл с именем `ContractFactory.sol`.

### Добавление шаблона

Представьте, что вы хотите создать контракт, который может хранить имя своего владельца и делать ему комплимент по запросу. Вы можете создать этот контракт довольно легко.

<Accordion title="Показать код">

```solidity
contract Complimenter {
    string public name;

    constructor(string memory _name) {
        name = _name;
    }

    function compliment() public view returns(string memory) {
        return string.concat("You look great today, ", name);
    }
}
```

</Accordion>

Разверните и протестируйте.

### Создание фабрики

Контракт `Complimenter` - огромный успех! Людям нравится, как он заставляет их чувствовать себя, и у вас клиенты стучатся в двери и окна. Отлично!

Единственная проблема в том, что требуется время и усилия, чтобы вручную развернуть новую версию контракта для каждого клиента. К счастью, есть способ написать контракт, который будет действовать как портал самообслуживания для ваших клиентов.

Начните с добавления контракта под названием `ComplimenterFactory`. Интерфейс Remix упрощает работу, если вы оставите фабрику в том же файле, что и `Complimenter`.

Добавьте функцию под названием `CreateComplimenter`, которая является public, принимает `string` с именем `_name` и возвращает `address`.

Создание нового контракта просто: `new Complimenter(_name)`

Вы также можете сохранить возвращаемое значение от этого создания в переменную. Эта ссылка может использоваться для вызова публичных функций в развернутом контракте и может быть приведена к типу address. Мы можем использовать ее для получения простой ссылки для поиска копий, созданных фабрикой. Конечный результат должен быть похож на:

<Accordion title="Показать код">

```solidity
contract ComplimenterFactory {
    function CreateComplimenter(string memory _name) public returns (address) {
        Complimenter newContract = new Complimenter(_name);
        return address(newContract);
    }
}
```

</Accordion>

### Тестирование

Очистите окружение, если еще не сделали этого, затем начните с развертывания `ComplimenterFactory`. Вы усердно работали и заслуживаете хороших вещей, поэтому вызовите `CreateComplimenter` со своим именем.

В терминале _декодированный вывод_ будет адресом нового контракта.

```text
{
	"0": "address: 0x9e0BC6DB02E5aF99b8868f0b732eb45c956B92dD"
}
```

Скопируйте **только** адрес.

Переключите _CONTRACT_, который нужно развернуть, на `Complimenter`, затем вставьте скопированный адрес в поле рядом с кнопкой _At Address_, которая находится ниже кнопки _Deploy_.

<Frame>
![At address button](/images/learn/new-keyword/at-address.png)
</Frame>

Нажмите _At Address_, и экземпляр `Complimenter` должен появиться ниже `ComplimenterFactory`. Протестируйте, чтобы подтвердить, что он работает, затем попробуйте развернуть больше экземпляров с помощью фабрики.

<Frame>
![Deployed](/images/learn/new-keyword/deployed.png)
</Frame>

<Tip>
Если развернутый контракт появляется, но является сломанной копией фабрики, это потому, что вы не изменили контракт в выпадающем списке _CONTRACT_ над кнопкой развертывания.

Remix пытается взаимодействовать с `Complimenter`, используя _ABI_ из контракта фабрики, что не сработает.
</Tip>


---

## Заключение

В этом уроке вы узнали, как развертывать контракты из другого контракта, используя ключевое слово `new`. Вы также узнали, что сегодня вы выглядите отлично!

---

[creates other contracts]: https://docs.soliditylang.org/en/v0.8.17/control-structures.html?#creating-contracts-via-new
