---
title: Упражнение по работе с хранилищем
sidebarTitle: Упражнение
description: Упражнение - продемонстрируйте свои знания о хранилище.
hide_table_of_contents: false
---

import { Danger } from "/snippets/danger.mdx";

Создайте контракт, соответствующий следующим спецификациям:

---

## Контракт

Создайте один контракт с именем `EmployeeStorage`. Он не должен наследоваться от других контрактов. Он должен иметь следующие функции:

### Переменные состояния

Контракт должен иметь следующие переменные состояния, оптимизированные для минимизации использования хранилища:

- Приватная переменная `shares`, хранящая количество акций, принадлежащих сотруднику
  - Сотрудники с более чем 5 000 акций считаются директорами и хранятся в другом контракте
-Публичная переменная `name`, которая хранит имя сотрудника
- Приватная переменная `salary`, хранящая зарплату сотрудника
  - Зарплаты варьируются от 0 до 1 000 000 долларов
- Публичная переменная `idNumber`, хранящая идентификационный номер сотрудника
  - Номера сотрудников не являются последовательными, поэтому это поле должно позволять любое число до 2^256-1

### Конструктор

При развертывании контракта используйте `constructor` для установки:

- `shares`
- `name`
- `salary`
- `idNumber`

Для целей теста вы **должны** развернуть контракт со следующими значениями:

- `shares` - 1000
- `name` - Pat
- `salary` - 50000
- `idNumber` - 112358132134

### Просмотр зарплаты и акций

<Danger>
В мире блокчейна ничто не является секретным!\* Приватные (`private`) переменные предотвращают чтение значения другими контрактами. Вы должны использовать их как часть чистых практик программирования, но пометка переменной как private **не скрывает значение**. Все данные тривиально доступны любому, кто знает, как извлекать данные из цепи.

\*Хотя вы можете умно использовать шифрование!
</Danger>


Напишите функцию `viewSalary`, которая возвращает значение `salary`.

Напишите функцию `viewShares`, которая возвращает значение `shares`.

### Назначение акций

Добавьте публичную функцию `grantShares`, которая увеличивает количество акций, выделенных сотруднику, на `_newShares`. Она должна:

- Добавить указанное количество акций к `shares`
  - Если это приведет к количеству акций более 5000, выполнить откат (revert) с пользовательской ошибкой `TooManyShares`, которая возвращает количество акций, которое будет у сотрудника с добавленным новым количеством
  - Если количество `_newShares` больше 5000, выполнить откат со строковым сообщением "Too many shares"

### Проверка упаковки и функция сброса акций для отладки

Добавьте следующую функцию в ваш контракт точно так, как написано ниже.

```solidity
/**
* Не изменяйте эту функцию. Она используется для того, чтобы модульный тест для этого задания
* мог проверить, правильно ли вы настроили ваши переменные хранилища для
* использования упаковки.
*
* Если вы хотите сжульничать, просто измените эту функцию так, чтобы она всегда возвращала `0`
* Я не ваш начальник ¯\_(ツ)_/¯
*
* Предупреждение: если вы сжульничаете, это будет в блокчейне, 
* развернуто вашим кошельком.... НАВСЕГДА!
*/
function checkForPacking(uint _slot) public view returns (uint r) {
    assembly {
        r := sload (_slot)
    }
}

/**
* Внимание: Любой может использовать эту функцию в любое время!
*/
function debugResetShares() public {
    shares = 1000;
}
```

---

### Отправьте свой контракт и получите NFT-значок! (BETA)

<Note>
#### Эй, куда делся мой NFT?!

[Тестовые сети](/learn/deployment-to-testnet/test-networks) не являются постоянными! Base Goerli [скоро будет приостановлена](https://base.mirror.xyz/kkz1-KFdUwl0n23PdyBRtnFewvO48_m-fZNzPMJehM4), в пользу Base Sepolia.

Поскольку это отдельные сети с отдельными данными, ваши NFT **не будут** перенесены.

**Не волнуйтесь!** Мы зафиксировали адреса всех владельцев NFT на Base Goerli и включим их, когда позже в этом году выпустим механизм переноса этих NFT в основную сеть! Вы также можете повторно развернуть на Sepolia и повторно отправить, если хотите!
</Note>


{/* <CafeUnitTest nftNum={3}/> */}

<iframe
  src="https://684b5e62b1ff46bc5bf83966-aijszlfakk.chromatic.com/iframe.html?args=&id=components-cafeunittest--three&viewMode=story&dark=true&hero=true"
  width="100%"
  height="auto"
/>
