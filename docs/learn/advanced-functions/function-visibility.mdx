---
title: Видимость функций и изменяемость состояния
sidebarTitle: Обзор видимости
description: Краткий справочник по всем вариантам объявления функций.
hide_table_of_contents: false
---

Вы уже видели большую часть этого материала ранее, но этот документ структурирует и освещает все варианты видимости функций и изменяемости состояния в одном месте.

---

## Цели обучения

После изучения этого урока вы сможете:

- Классифицировать функции как public, private, internal или external на основе их использования
- Описать, чем pure и view функции отличаются от функций, изменяющих хранилище

---

## Видимость функций

В Solidity существует четыре типа [visibility] функций: `external`, `public`, `internal`, and `private`. Эти метки представляют собой дальнейшее разделение меток _public_ и _private_, которые вы могли бы использовать в других языках.

### External

Функции с видимостью `external` **только** вызываемы из других контрактов и не могут быть вызваны внутри собственного контракта. Вы могли видеть старые рекомендации о том, что следует использовать `external` вместо `public`, потому что это заставляет функцию использовать `calldata`. Это больше не верно, так как оба типа видимости теперь могут использовать `calldata` и `memory` для параметров. Однако использование `calldata` в любом случае будет стоить меньше газа.

```solidity
contract Foo {
    constructor() {
        // Пример плохого кода, не будет работать
        uint bar = foo(3);
        // ... другой код
    }

    function foo(uint _number) external pure returns (uint) {
         return _number*2;
    }
}
```

### Public

Public функции работают так же, как и external, за исключением того, что они также могут вызываться внутри контракта, который их содержит.

```solidity
contract Foo {
    constructor() {
        // Public функции могут вызываться внутри контракта
        uint bar = foo(3);
        // ... другой код
    }

    function foo(uint _number) public pure returns (uint) {
        return _number*2;
    }
}
```

### Private и Internal

Функции с видимостью `private` и `internal` работают почти идентично. Помимо написания чистого кода, они оказывают очень важное влияние. Поскольку они не являются частью ABI контракта, вы можете использовать `mapping` и ссылки на `storage` переменные в качестве параметров.

Разница заключается в том, что `private` функции не могут вызываться из производных контрактов. Вы узнаете больше об этом, когда будем изучать наследование.

Некоторые разработчики добавляют символ подчеркивания перед названиями `private` и `internal` функций.

```solidity
function _foo(uint _number) private returns (uint) {
    return _number*2;
}
```

<Warning>
Все данные в блокчейне являются публичными. Не путайте сокрытие видимости при написании кода со сокрытием информации от мира!
</Warning>


---

## Изменяемость состояния функций

Метки изменяемости состояния относительно уникальны для Solidity. Они определяют, как функция может взаимодействовать с состоянием, что существенно влияет на стоимость газа.

### Pure

`pure` функции гарантируют, что они не будут ни читать, ни записывать состояние. Обычно они используются для вспомогательных функций, которые поддерживают другую функциональность.

```solidity
function abs(int x) public pure returns (int) {
    return x >= 0 ? x : -x;
}
```

`pure` функции могут вызываться извне блокчейна без использования газа, если они также являются `public` или `external`.

### View

`view` функции обращаются к состоянию, но не изменяют его. Вы использовали их для таких задач, как возврат всех значений в массиве.

```solidity
function getArr() public view returns (uint[] memory) {
    return arr;
}
```

`view` функции могут вызываться извне блокчейна без использования газа, если они также являются `public` или `external`.

### Функции без меток

Функции, которые не помечены как `view` или `pure`, могут изменять состояние, и компилятор выдаст предупреждение, если они этого не делают.

```solidity
function addToArr(uint _number) public {
    arr.push(_number);
}
```

Они могут иметь любую видимость и всегда будут стоить газа при вызове.

---

## Заключение

Ключевые слова видимости и изменяемости в Solidity помогают вам организовывать код и предупреждать других разработчиков о свойствах каждой из ваших функций. Используйте их, чтобы ваш код оставался организованным и читаемым.

---

[visibility]: https://docs.soliditylang.org/en/v0.8.17/contracts.html?highlight=pure#function-visibility

