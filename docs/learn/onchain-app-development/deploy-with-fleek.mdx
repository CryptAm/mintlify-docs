---
title: 'Развертывание ончейн-приложения с помощью Fleek'
description: Узнайте, как развернуть ончейн-приложение с использованием Fleek.
authors:
  - briandoyle81
tags: ['frontend']
difficulty: hard
hide_table_of_contents: false

image: https://docs.base.org/img/base-learn-open-graph.png
---

# Развертывание ончейн-приложения с помощью Fleek

Одна из «секретов» ончейн-приложений заключается в том, что почти всегда у них есть очень крупный web2-компонент, от которого они зависят. Большинство ончейн-приложений полагаются на традиционную инфраструктуру для своих фронтендов, API и других частей архитектуры.

Цель [Fleek] - решить эту проблему с помощью [Fleek Network] - быстрой и не требующей доверия сети доставки контента (CDN).

В этом руководстве вы используете [Fleek] для развертывания сайта, созданного на основе [Onchain App Template].

## Цели

К концу этого руководства вы должны уметь:

- Развернуть [Next.js] приложение с использованием [Smart Wallet] от Coinbase на [Fleek]
- Интегрировать [Github] для CI/CD

## Предварительные требования

### Next.js

Вы должны быть знакомы с [Next.js], но необязательно быть экспертом. Если вы работали с другими библиотеками React, шаблон будет относительно прост для понимания.

### Ончейн-приложения

Предполагается, что вы знакомы с основами развертывания приложения и его подключения к смарт-контракту. Если вы все еще изучаете эту часть, ознакомьтесь с нашими руководствами на [Base Learn] по [Building an Onchain App].

## Настройка шаблона

Этот раздел можно пропустить, если вы уже создавали приложение на основе этого шаблона, например, по нашему руководству [How to Mint on Zora with an App].

Откройте [Onchain App Template], нажмите зеленую кнопку `Use this template` и создайте новый репозиторий из шаблона. Склонируйте свой репозиторий и откройте его в редакторе кода.

Установите _bun_ при необходимости, а затем зависимости

```bash
# Установите bun, если он не установлен
curl -fsSL https://bun.sh/install | bash

# Установите пакеты
bun i

# Запустите приложение Next
bun run dev
```

Перейдите по адресу `localhost:3000`, убедитесь, что все работает, а затем остановите сервер. Для этого руководства **не нужно** задавать переменные окружения

## Установка и настройка Fleek

[Fleek] требует статические страницы, поэтому необходимо убедиться, что ваш процесс сборки их создает. В редакторе откройте `next.config.js` и обновите `nextConfig`.

```javascript
/** @type {import('next').NextConfig} */
const nextConfig = {
  output: 'export',
  reactStrictMode: true,
  images: {
    unoptimized: true,
  },
  trailingSlash: true,
};

module.exports = nextConfig;
```

Сохраните и закройте файл.

Запустите `bun run build` и убедитесь, что создана директория с именем `out`.

Перейдите на сайт [Fleek], создайте аккаунт или войдите в систему, если он уже есть.

Нажмите на `First Project`. При желании его можно переименовать во вкладке `Settings`.

Лучше всего начать, привязав Fleek к вашему репозиторию с самого начала. Нажмите `Add New` в правом верхнем углу, затем выберите `Deploy My Site`. Выберите местоположение кода, войдите в свою учетную запись Git-провайдера и согласитесь установить приложение Fleek

Можно предоставить разрешения для всех репозиториев или добавлять их по одному

Выберите свой репозиторий и нажмите кнопку `Deploy`. Окно `Configure Site` должно автоматически заполниться соответствующей информацией, но на всякий случай проверьте:

- Site Name: Имя вашего сайта
- Framework: Next.js
- Branch: main
- Publish Directory: out
- Build Command: npm install && npm run build

Нажмите `Deploy Site`. Скорее всего, развертывание завершится неудачей, но это ожидаемо!

Вернитесь в редактор кода.

Откройте терминал и установите Fleek CLI с помощью команды:

```bash
npm install -g @fleek-platform/cli
```

Затем в **корневой директории вашего проекта** выполните:

```bash
fleek login
```

Нажмите на ссылку в терминале, а затем нажмите `Confirm` на открывшейся веб-странице. После подключения нажмите кнопку `Visit Dashboard`. Сайт автоматически создаст проект с именем `First Project`. При желании его можно переименовать или добавить новый.

Каждый проект может включать более одного сайта.

Вернитесь в терминал в папке приложения и выполните:

```bash
fleek sites init
```

Выберите `First Projec`t из списка:

```
⚠️ Warning! To proceed, please select a project...

✔ Select a project from the list: › First Project

✅ Success! You have switched to project "First Project".
```

На запрос `We've found existing sites. Would you like to link to one of them?`, выберите: `Y`

Найдите только что добавленный сайт и выберите его.

<Warning>
Вы используете TypeScript, но **не выбирайте** `TypeScript (fleek.config.ts)` в последнем запросе. Выберите `JSON (fleek.config.json)`.
</Warning>

Появится еще несколько запросов:

- ? Please specify the directory containing the site files to be uploaded
  - Введите `out`
- ? Would you like to include the optional "build" command?
  - Введите `Y`
- ? Specify `build` command:
  - Введите `npm install && npm run build`
  - Выберите `JSON (fleek.config.json)`

### Развертывание

Развернуть сайт можно из CLI, как описано в документации, но **в этом нет необходимости**. Есть лучший способ!

```bash
# Не используйте, ниже показан лучший метод!
fleek sites deploy
```

Вместо этого запустите автоматическое развертывание, внеся изменение в текст в файле `src/app/page.tsx`, закоммитив изменения и отправив их в свой репозиторий.

## Обзор панели управления и подтверждение развертывания

Вернитесь в свою панель управления и нажмите на вкладку `Sites`. Нажмите на карточку вашего нового сайта, чтобы открыть ее. Здесь вы можете увидеть информацию о вашем сайте в формате, аналогичном другим провайдерам развертывания.

Нажмите на вкладку `<-> Deploys`, и вы увидите автоматическое развертывание, которое запустили пушем коммита! Откройте свой сайт, нажав на сборку, когда ее статус изменится с `Pending` на `Live`. Затем вы можете нажать на ссылку, чтобы просмотреть свой сайт.

Нажмите на `Settings`. При желании можно изменить slug (идентификатор) для вашего сайта на более подходящее для вашего проекта имя.

## Заключение

В этом руководстве вы узнали, как использовать [Fleek] для развертывания сайта на [Next.js] основанного на [Onchain App Template]. Вы также узнали, как связать Fleek с вашим Git-провайдером для включения CI/CD

[Base Learn]: https://base.org/learn
[Smart Wallet]: https://www.smartwallet.dev/why
[Fleek]: https://fleek.xyz
[Fleek Network]: https://fleek.xyz/blog/announcements/introducing-fleek-network-and-fleek-xyz/
[Next.js]: https://nextjs.org/
[Onchain App Template]: https://github.com/coinbase/onchain-app-template
[Smart Wallet]: https://www.coinbase.com/wallet/smart-wallet
[How to Mint on Zora with an App]: /use-case-guides/creator/nft-minting-with-zora.mdx


