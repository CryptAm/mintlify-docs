---
title: fetchOnrampTransactionStatus
---

Утилита fetchOnrampTransactionStatus получает статус транзакций покупки криптовалюты для конкретного пользователя. Это полезно для отслеживания прогресса покупок и отображения истории транзакций.

## Использование

<CodeGroup>
```tsx code
import { fetchOnrampTransactionStatus } from '@coinbase/onchainkit/fund';

const transactions = await fetchOnrampTransactionStatus({
partnerUserId: 'user123',
nextPageKey: '',
pageSize: '10',
apiKey: 'your-api-key', // Обязателен при использовании без OnchainKitProvider или вне окружения React
});

````

```json return value
{
  "transactions": [
    {
      "id": "tx123",
      "status": "ONRAMP_TRANSACTION_STATUS_SUCCESS",
      "purchaseAmount": { "value": "0.1", "currency": "ETH" },
      "paymentAmount": { "value": "200.00", "currency": "USD" },
      "network": "ethereum",
      "createdAt": "2024-01-01T12:00:00Z"
    }
  ],
  "nextPageKey": "next_page_token",
  "totalCount": "1"
}
````

</CodeGroup>

## Параметры

```typescript
{
  /**
   * Уникальный идентификатор, который будет связан с любыми транзакциями,
   * созданными пользователем во время его сессии Onramp. Его можно использовать
   * с API статуса транзакций для проверки статуса транзакции пользователя.
   * См. https://docs.cdp.coinbase.com/onramp/docs/api-reporting#buy-transaction-status
   */
  partnerUserId: string; // Ваш уникальный идентификатор пользователя
  nextPageKey: string;   // Токен для постраничной навигации (пагинации)
  pageSize: string;      // Количество транзакций на страницу
  /**
   * Необязательный API-ключ для Coinbase Onramp. Если не предоставлен,
   * будет использован API-ключ из OnchainKitProvider. Обязателен при использовании
   * утилиты без OnchainKitProvider или вне окружения React.
   */
  apiKey?: string;
}
```

## Возвращает

`Promise<OnrampTransactionStatusResponseData>` - Возвращает промис, который резолвится в данные статуса транзакции.

```typescript
type OnrampTransactionStatusResponseData = {
  transactions: OnrampTransaction[];
  nextPageKey?: string;
  totalCount: string;
};

type OnrampTransaction = {
  status: OnrampTransactionStatusName;
  purchaseCurrency: string;
  purchaseNetwork: string;
  purchaseAmount: OnrampAmount;
  paymentTotal: OnrampAmount;
  paymentSubtotal: OnrampAmount;
  coinbaseFee: OnrampAmount;
  networkFee: OnrampAmount;
  exchangeRate: OnrampAmount;
  txHash: string;
  createdAt: string;
  country: string;
  userId: string;
  paymentMethod: string;
  transactionId: string;
};

type OnrampTransactionStatusName =
  | 'ONRAMP_TRANSACTION_STATUS_UNSPECIFIED'
  | 'ONRAMP_TRANSACTION_STATUS_CREATED'
  | 'ONRAMP_TRANSACTION_STATUS_IN_PROGRESS'
  | 'ONRAMP_TRANSACTION_STATUS_SUCCESS'
  | 'ONRAMP_TRANSACTION_STATUS_FAILED';

type OnrampAmount = {
  value: string;
  currency: string;
};
```
