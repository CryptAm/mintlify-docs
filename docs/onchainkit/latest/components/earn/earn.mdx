---
title: "Earn"
---

Компонент `Earn` предоставляет простой интерфейс для получения процентов на вашу криптовалюту через хранилища Morpho в сети Base.


## Быстрый старт

Для использования `Earn` вам необходимо предоставить пропс vaultAddress. Адрес хранилища можно получить на странице [Vaults page](https://app.morpho.org/base/earn) Morpho.

```tsx
import { Earn } from '@coinbase/onchainkit/earn'; // [!code focus]

<Earn vaultAddress="0x7BfA7C4f149E7415b73bdeDfe609237e29CBF34A" /> // [!code focus]
```

{/* <EarnMain /> */}

<iframe
  src="https://684b5e62b1ff46bc5bf83966-aijszlfakk.chromatic.com/iframe.html?args=&id=onchainkit-earn--main&viewMode=story&dark=true&hero=true"
  width="100%"
  height="400px"
/>

## Кастомизация

### Кастомные компоненты и макеты

`Earn` принимает пропс `children`, который можно использовать для рендеринга подкомпонентов `Earn` или кастомных компонентов.

Например, вы можете отрендерить компонент `EarnDeposit` отдельно внутри компонента `Earn`, а также любые другие кастомные компоненты, которые хотите отобразить.

```tsx
import { Earn, EarnDeposit } from '@coinbase/onchainkit/earn';

<Earn vaultAddress="0x7BfA7C4f149E7415b73bdeDfe609237e29CBF34A">
  <div>Custom header</div>
  <EarnDeposit />
  <div>Custom footer</div>
</Earn>
```

{/* <EarnDeposit /> */}

<iframe
  src="https://684b5e62b1ff46bc5bf83966-aijszlfakk.chromatic.com/iframe.html?args=&id=onchainkit-earn--deposit&viewMode=story&dark=true&hero=true"
  width="100%"
  height="450px"
/>

Для более детального контроля вы также можете рендерить компоненты более низкого уровня внутри `EarnDeposit` и `EarnWithdraw`. Эти подкомпоненты принимают свойства `className` для кастомизации их стилей.

```tsx
import { Earn,
        EarnDeposit,
        EarnDetails,
        DepositBalance,
        DepositAmountInput,
        DepositButton } from '@coinbase/onchainkit/earn';

<Earn vaultAddress="0x7BfA7C4f149E7415b73bdeDfe609237e29CBF34A">
  <EarnDeposit>
    <EarnDetails />
    <DepositBalance />
    <DepositAmountInput className="border-2 border-green-400" />
    <DepositButton />
  </EarnDeposit>
</Earn>
```

{/* <RearrangedEarnDeposit /> */}

<iframe
  src="https://684b5e62b1ff46bc5bf83966-aijszlfakk.chromatic.com/iframe.html?args=&id=onchainkit-earn--rearranged-deposit&viewMode=story&dark=true&hero=true"
  width="100%"
  height="400px"
/>

### Кастомизация стилей

Компонент `Earn` лучше всего стилизовать с помощью [OnchainKit theme](/onchainkit/guides/themes#custom-theme). Вы также можете переопределять стили отдельных компонентов, используя `className`.

## Продвинутое использование

Если вы хотите реализовать свои собственные кастомные компоненты, вы можете использовать `useEarnContext` внутри компонента `Earn` для доступа к контексту и создания собственных компонентов.

Полный интерфейс `EarnContextType` можно найти на странице [Types page](/onchainkit/earn/types#earncontexttype).

Ниже мы используем `useEarnContext` для реализации кастомного интерфейса депозита, получая доступ к значениям контекста `depositAmount` и `setDepositAmount`.

<CodeGroup>
```tsx index.tsx
import { Earn, useEarnContext } from '@coinbase/onchainkit/earn';
import { CustomDepositButtons } from '@/custom-deposit-buttons';

  <Earn vaultAddress="0x7BfA7C4f149E7415b73bdeDfe609237e29CBF34A">
      <CustomDepositButtons />
  </Earn>

```

```tsx custom-deposit-buttons.tsx
import {EarnDetails,
        EarnDeposit,
        useEarnContext,
        DepositButton} from '@coinbase/onchainkit/earn';

const predefinedAmounts = ['0.1', '1', '10'];

function CustomDepositButtons() {
  const { depositAmount, setDepositAmount } = useEarnContext();

  return (
    <EarnDeposit>
      <EarnDetails />
      <div className="grid grid-cols-3 gap-2">
        {predefinedAmounts.map((amount) => {
          const selected = amount === depositAmount;
          return (
            <button
              key={amount}
              type="button"
              onClick={() => setDepositAmount(amount)}
              className={`rounded-md px-4 py-2
              ${selected ? 'bg-[var(--ock-bg-primary)] text-[var(--ock-text-inverse)]'
              : 'bg-[var(--ock-bg-secondary)] text-[var(--ock-text-primary)]'}`}
            >
              {amount}
            </button>
          );
        })}
      </div>
      <DepositButton />
    </EarnDeposit>
  );
}
```
</CodeGroup>

{/* <PredefinedInputDeposit /> */}

<iframe
  src="https://684b5e62b1ff46bc5bf83966-aijszlfakk.chromatic.com/iframe.html?args=&id=onchainkit-earn--predefined-deposit&viewMode=story&dark=true&hero=true"
  width="100%"
  height="400px"
/>

Используя данные и методы, предоставляемые `useEarnContext`, разработчики могут реализовать полностью кастомные интерфейсы для депозита и вывода, изменяя все - от элементов пользовательского интерфейса до поведения полей ввода.

## Примеры

### Спонсирование транзакций

Для спонсирования транзакций вы можете использовать свойство `isSponsored`.

```tsx
<Earn vaultAddress="0x7BfA7C4f149E7415b73bdeDfe609237e29CBF34A" isSponsored />
```

Убедитесь, что в вашем `OnchainKitProvider` настроен `paymaster`:

```tsx
<OnchainKitProvider
  config={{ // [!code focus]
    paymaster: process.env.PAYMASTER_ENDPOINT, // [!code focus]
  }} // [!code focus]
>
```

<Tip>
Если у вас установлен разрешенный список контрактов на Coinbase Developer Platform, вам нужно убедиться, что разрешены следующие функции контрактов:

- `deposit` в хранилище Morpho
- `redeem` в хранилище Morpho
- `approve` на токене, который вносится
</Tip>


## Компоненты

Компонент `Earn` включает следующие подкомпоненты:

- `<Earn />` - Полностью собранный компонент для вывода и депозита. Также включает пропс `children` для рендеринга кастомных компонентов и предоставляет `useEarnContext` для доступа к значениям контекста.
- `<EarnProvider />` - Headless-провайдер, который предоставляет хук `useEarnContext` компоненту `Earn`.
- `<EarnDeposit />` - Полностью собранная карточка депозита.
- `<EarnWithdraw />` - Полностью собранная карточка вывода.
- `<EarnDetails />` - Компонент, отображающий детали хранилища.
- `<DepositAmountInput />` - Компонент, обрабатывающий ввод суммы депозита.
- `<DepositBalance />` - Компонент, отображающий баланс базового актива в кошельке пользователя.
- `<DepositButton />` - Компонент, запускающий транзакцию депозита.
- `<WithdrawAmountInput />` - Компонент, обрабатывающий ввод суммы вывода.
- `<WithdrawBalance />` - Компонент, отображающий, сколько пользователь может вывести из хранилища.
- `<WithdrawButton />` - Компонент, запускающий транзакцию вывода.
- `<YieldDetails />` - Компонент, отображающий детали доходности хранилища.
- `<VaultDetails />` - Компонент, отображающий детали хранилища.

## Хуки

- [`useEarnContext`](/onchainkit/hooks/use-earn-context) - Хук, предоставляющий значения контекста компонента `Earn`.
- [`useBuildDepositToMorphoTx`](/onchainkit/hooks/use-build-deposit-to-morpho-tx) - Хук, который создает транзакцию депозита в Morpho.
- [`useBuildWithdrawFromMorphoTx`](/onchainkit/hooks/use-build-withdraw-from-morpho-tx) - Хук, который создает транзакцию вывода из Morpho.
- [`useMorphoVault`](/onchainkit/hooks/use-morpho-vault) - Хук, который предоставляет детали хранилища Morpho.

## Свойства

[`EarnProps`](#earnprops)

```ts
type EarnProps = {
  children?: React.ReactNode;
  className?: string;
  vaultAddress: Address;
  isSponsored?: boolean;
  /** Опциональная функция-обработчик ошибок внутри провайдера. */
  onError?: (error: TransactionError) => void;
  /** Опциональная функция-обработчик, которая предоставляет доступ к состоянию жизненного цикла компонента */
  onStatus?: (lifecycleStatus: LifecycleStatus) => void;
  /** Опциональная функция-обработчик, которая предоставляет доступ к квитанции о транзакции */
  onSuccess?: (transactionReceipt?: TransactionReceipt) => void;
};
```

[`EarnProviderProps`](#earnproviderprops)

```ts
type EarnProviderProps = {
  children: React.ReactNode;
  vaultAddress: Address;
  isSponsored?: boolean;
  /** Опциональная функция-обработчик ошибок внутри провайдера. */
  onError?: (error: TransactionError) => void;
  /** Опциональная функция-обработчик, которая предоставляет доступ к состоянию жизненного цикла компонента */
  onStatus?: (lifecycleStatus: LifecycleStatus) => void;
  /** Опциональная функция-обработчик, которая предоставляет доступ к квитанции о транзакции */
  onSuccess?: (transactionReceipt?: TransactionReceipt) => void;
};
```

[`EarnContextType`](#earncontexttype)

```ts
type EarnContextType = {
  /** Предупреждает пользователей, если адрес хранилища невалиден */
  error: Error | null;
  recipientAddress?: Address;
  /** Баланс базового актива в кошельке пользователя, конвертированный с учетом десятичных знаков актива */
  walletBalance?: string;
  /** Статус получения баланса кошелька */
  walletBalanceStatus: 'pending' | 'success' | 'error';
  refetchWalletBalance: () => void;
  vaultAddress: Address;
  /** Токен, который вносится или выводится (базовый актив хранилища) */
  vaultToken: Token | undefined;
  vaultName: string | undefined;
  /** Общие депозиты в хранилище */
  deposits: string | undefined;
  /** Общая ликвидность (доступная для займа) в хранилище */
  liquidity: string | undefined;
  /** Общая APY хранилища, включая награды */
  apy: number | undefined;
  nativeApy: UseMorphoVaultReturnType['nativeApy'];
  vaultFee: UseMorphoVaultReturnType['vaultFee'];
  /** Награды, полученные пользователем в хранилище */
  rewards: UseMorphoVaultReturnType['rewards'];
  /** Количество базового актива, внесенное в хранилище подключенным пользователем */
  depositedBalance?: string;
  /** Статус получения баланса депозита */
  depositedBalanceStatus: 'pending' | 'success' | 'error';
  refetchDepositedBalance: () => void;
  /** Процентный доход, полученный пользователем в хранилище */
  interestEarned?: string;
  /** Сумма, которую пользователь ввел в поле ввода суммы депозита */
  depositAmount: string;
  setDepositAmount: (amount: string) => void;
  depositAmountError: string | null;
  depositCalls: Call[];
  /** Сумма, которую пользователь ввел в поле ввода суммы вывода */
  withdrawAmount: string;
  setWithdrawAmount: (amount: string) => void;
  withdrawAmountError: string | null;
  withdrawCalls: Call[];
  lifecycleStatus: LifecycleStatus;
  updateLifecycleStatus: (
    status: LifecycleStatusUpdate<LifecycleStatus>,
  ) => void;
};
```

[`LifecycleStatus`](#lifecyclestatus)

```ts
type LifecycleStatus =
  | {
      statusName: 'init';
      statusData: null;
    }
  | {
      statusName: 'amountChange';
      statusData: {
        amount: string;
        token: Token;
      };
    }
  | Extract<
      TransactionLifecycleStatus,
      {
        statusName:
          | 'transactionPending'
          | 'transactionLegacyExecuted'
          | 'success'
          | 'error';
      }
    >;
```

Дополнительные пропсы компонентов:

```ts
// Компоненты ввода
type DepositAmountInputProps = { className?: string; };
type WithdrawAmountInputProps = { className?: string; };

// Компоненты баланса   
type DepositBalanceProps = { className?: string; };
type WithdrawBalanceProps = { className?: string; };

// Контейнерные компоненты
type EarnDepositProps = { children?: React.ReactNode; className?: string; };
type EarnWithdrawProps = { children?: React.ReactNode; className?: string; };

// Компоненты действий
type DepositButtonProps = { className?: string; };
type WithdrawButtonProps = { className?: string; };
type EarnDetailsProps = { className?: string; };
```

