---
title: 'Использование Coinbase Smart Wallet и EOAs с OnchainKit'
description: Узнайте, как использовать OnchainKit для простой одновременной работы с Coinbase Smart Wallet и кошельками EOA, включая кошелек Coinbase.
---

import { Danger } from "/snippets/danger.mdx";

The [Coinbase Smart Wallet] - отличный способ познакомить новых пользователей с ончейн-приложениями, а также предлагает ряд улучшений опыта для существующих пользователей криптовалют. Поскольку мы находимся в периоде внедрения и перехода, возникла проблема: пользователь, у которого есть и Smart Wallet, и EOA в виде расширения браузера, не всегда может выбрать нужный кошелек при подключении к приложению.

В этом руководстве вы узнаете, как упростить этот опыт, используя компонент [Wallet] из [OnchainKit] для подключения ваших пользователей к вашему приложению.

## Цели

К концу этого руководства вы сможете:

- Создать опыт подключения с помощью компонента `Wallet` из [OnchainKit]
- Настроить компонент `Wallet`, чтобы позволить пользователям подключаться из выбранного списка кошельков
- Дать пользователям возможность выбрать или EOA при подключении к вашему приложению с помощью RainbowKit

## Предварительные требования

### Знакомство с современной фронтенд-разработкой

В этом руководстве вы будете работать с React-фронтендом, созданным с помощью [Next.js]. Хотя вам не нужно быть экспертом, мы предполагаем, что вы знакомы с основами.

### Общее понимание EVM и разработки смарт-контрактов

Это руководство предполагает, что вы достаточно уверенно пишете базовые смарт-контракты. Если вы только начинаете, перейдите к нашим руководствам [Base Learn] и начните обучение!

### Понимание провайдеров и коннекторов

Вам нужно понимать, как соединить ончейн-приложение с блокчейном через провайдер.
Если вы ещё не знакомы с этим, начните с раздела [Onchain App Development] в [Base Learn], или как минимум пройдите руководство [Introduction to Providers].

### Coinbase кошельки

В этом руководстве используются и [Coinbase Wallet], и [Coinbase Smart Wallet]. Обычный Coinbase Wallet необходимо подготовить заранее. Смарт-кошелёк можно создать в процессе.

## Базовый сценарий использования

Создайте новое приложение с помощью [Onchain App Template]. Нажмите `Use this template`, создайте репозиторий и клонируйте его. 

Вам потребуется `WalletConnect-ID`. Получите его, затем скопируйте `.env.local.example` → `.env.local` и задайте `NEXT_PUBLIC_WC_PROJECT_ID` равным вашему ID.

Установите зависимости и запустите приложение:

```bash
bun install
bun run dev
```

<Note>
Чтобы сделать ончейн доступным широкой аудитории, используйте более привычную терминологию. Например, `Log In`, а не `Connect Wallet`.
</Note>


Демо-приложение содержит разделы, показывающие ряд компонентов [OnchainKit], включая [Wallet]. Нажмите `Log in` в вашем браузере при наличии расширения Coinbase Wallet, выберите `Coinbase Wallet`, и вы получите ожидаемый опыт для пользователя EOA-кошелька с расширением браузера.

<Frame>
![Default eoa](/images/smart-wallet/onchainkit-default-eoa.png)
</Frame>

Теперь откройте приложение в приватном окне без расширений и повторите вход. Появится интерфейс Smart Wallet. Если смарт-кошелька ещё нет, его можно создать сразу.

<Frame>
![Default smart wallet](/images/smart-wallet/onchainkit-default-smart.png)
</Frame>

## Настройка списка кошельков

Список доступных кошельков можно кастомизировать с помощью [Wallet Aggregator].

### Настройка Wallet Aggregator

Откройте `src/app/page.tsx`. Здесь вы найдете корневую страницу приложения. Вы можете увидеть `<WalletWrapper />`, который вы использовали для входа и выхода.

Откройте `src/components/WalletWrapper.tsx` и src/wagmi.ts. Взгляните на `WalletWrapper`. Это надежная реализация нескольких компонентов , которая показывает, как можно создать опыт входа, который хорошо работает для всех типов пользователей, и предоставляет компонент `<Identity>` после входа.

Вы можете настроить это, внеся некоторые изменения в `wagmi.ts`.

Начните с `wagmi.ts`. Обновите его, чтобы импортировать коннекторы для кошельков, которые вы хотите использовать (мы просто выбрали те, что в конце списка поддерживаемых. Проведите свое исследование, какие кошельки поддерживать!):

```tsx
import { http, createConfig } from 'wagmi';
import { baseSepolia } from 'wagmi/chains';
import {
  coinbaseWallet,
  metaMaskWallet,
  rainbowWallet,
  uniswapWallet,
  walletConnectWallet,
  xdefiWallet,
  zerionWallet,
} from '@rainbow-me/rainbowkit/wallets';
import { connectorsForWallets } from '@rainbow-me/rainbowkit';
```

Затем обновите `connectorsForWallets`, чтобы использовать выбранные вами кошельки в группировках на ваш выбор:

```tsx
const connectors = connectorsForWallets(
  [
    {
      groupName: 'Recommended Wallet',
      wallets: [coinbaseWallet],
    },
    {
      groupName: 'Other Wallets',
      wallets: [rainbowWallet, metaMaskWallet, walletConnectWallet],
    },
    {
      groupName: 'U Wallets',
      wallets: [uniswapWallet],
    },
    {
      groupName: 'X Wallets',
      wallets: [xdefiWallet],
    },
    {
      groupName: 'Z Wallets',
      wallets: [zerionWallet],
    },
  ],
  {
    appName: 'onchainkit',
    projectId,
  },
);
```

Попробуйте подключиться снова. Вы увидите обновленный список с кошельками, организованными по вашему предпочтению!

<Frame>
![Настроенный список](/images/smart-wallet/customized-wallet-list.png)
</Frame>

## Настройка подключения Coinbase Wallet

<Danger>
Если вы уже подключались к сайту, описанное ниже не сработает, пока вы не очистите данные сайта! Будет казаться, что флаг ничего не делает.

В Chrome: Инструменты разработчика -> Вкладка Application -> Вкладка Storage -> Кнопка Clear Site Data
В Firefox: Инструменты разработчика -> Storage -> Правой кнопкой по каждому элементу -> Delete All
</Danger>


С помощью RainbowKit вы можете заставить коннектор использовать только умный кошелек или только EOA с помощью:

```tsx
coinbaseWallet.preference = 'smartWalletOnly';
```

И:

```tsx
coinbaseWallet.preference = 'eoaOnly';
```

Значение по умолчанию:

```tsx
coinbaseWallet.preference = 'all';
```

Установите эту строку на корневом уровне в `wagmi.ts`, под импортами:

```tsx
import { http, createConfig } from 'wagmi';
import { baseSepolia } from 'wagmi/chains';
import {
  coinbaseWallet,
  metaMaskWallet,
  rainbowWallet,
  walletConnectWallet,
} from '@rainbow-me/rainbowkit/wallets';
import { connectorsForWallets } from '@rainbow-me/rainbowkit';

coinbaseWallet.preference = 'all';
```

Настройка `all` демонстрирует поведение, которое вы наблюдали ранее. Если EOA присутствует, он будет использован. В противном случае появится интерфейс Smart Wallet.

Вы можете использовать эти настройки, чтобы направлять пользователей вашего приложения к предпочтительному варианту использования или привязать их к элементу UI, чтобы дать им выбор.

<Note>
Coinbase Smart Wallet скоро будет поддерживать выбор пользователем кошелька!
</Note>


## Заключение

В этом руководстве вы узнали, как использовать для входа ваших пользователей в ваше ончейн-приложение. Вы также узнали, как настроить опыт подключения с помощью , предоставив вашим пользователям более широкий выбор кошельков для использования с вашим приложением и убедившись, что все могут им наслаждаться.

---

[Base Learn]: https://base.org/learn
[Next.js]: https://nextjs.org/
[RainbowKit]: https://rainbowkit.com/
[wagmi]: https://wagmi.sh/
[viem]: https://viem.sh/
[quick start]: https://www.rainbowkit.com/docs/installation
[WalletConnect]: https://cloud.reown.com/
[smart contract development]: https://base.org/learn
[Base]: /base-chain/quickstart/use-base
[smart contract development]: https://base.org/camp
[`createConfig`]: https://wagmi.sh/react/api/createConfig
[Introduction to Providers]: ./intro-to-providers
[Onchain App Development]: /learn/frontend-setup/overview
[Coinbase Wallet]: https://www.coinbase.com/wallet
[Coinbase Smart Wallet]: https://www.coinbase.com/wallet/smart-wallet
[custom wallet list]: https://www.rainbowkit.com/docs/custom-wallet-list
[OnchainKit]: https://onchainkit.xyz/?utm_source=basedocs&utm_medium=tutorials&campaign=smart-wallet-and-eoa-with-onchainkit
[Wallet]: https://onchainkit.xyz/wallet/wallet
[Onchain App Template]: https://github.com/coinbase/onchain-app-template
[Wallet Aggregator]: https://onchainkit.xyz/wallet/wallet#use-wallet-aggregator

