---
title: 'Ошибки Paymaster & Bundler'
sidebar_label: Ошибки
---

Узнайте о кодах ошибок Paymaster и Bundler, а также о способах их устранения.

Если ошибка не исчезает, присоединяйтесь к [Coinbase Developer Platform Discord](https://discord.com/invite/cdp) и обратитесь к нам в канале `#paymaster` за помощью.

## Коды ошибок Paymaster

Ниже приведен список распространенных кодов ошибок, возвращаемых Paymaster.

| Ошибка               | Код    | Описание                                                                                                                          |
| :------------------- | :----- | :-------------------------------------------------------------------------------------------------------------------------------- |
| INTERNAL_ERROR       | -32000 | Внутренняя ошибка. Что-то не так с нашим сервисом. Пожалуйста, обратитесь в поддержку, если ошибка не исчезает.                                 |
| UNAUTHORIZED_ERROR   | -32001 | Не авторизовано. Проверьте, действительны ли ваш API-ключ и RPC URL.                                                                            |
| DENIED_ERROR         | -32002 | Запрос отклонен. Это может быть связано с политикой газа, которую вы настроили на странице Paymaster. Проверьте значения в вашей политике газа. |
| UNAVAILABLE_ERROR    | -32003 | Сервис недоступен. Пожалуйста, обратитесь в поддержку, если ошибка не исчезает.                                                                 |
| GAS_ESTIMATION_ERROR | -32004 | Произошла ошибка во время eth_estimateUserOperation. Обычно это связано с недостаточным газом или неверной подписью paymaster.                  |
| METHOD_NOT_FOUND     | -32601 | Метод не найден. Проверьте, включен ли Paymaster на вашем RPC URL, и правильно ли вы отправляете JSON-RPC метод.                                |
| INVALID_ARGUMENT     | -32602 | Неверный аргумент. Убедитесь, что в UserOperation указаны корректные параметры.                                                                 |
| PARSE_ERROR          | -32700 | Ошибка разбора. Убедитесь, что в UserOperation указаны корректные параметры и тело запроса отформатировано правильно.                           |

## Ошибки политики газа Paymaster

| Сообщение                                                     | Описание                                                          |
| :------------------------------------------------------------ | :---------------------------------------------------------------- |
| rejected due to max per user op Spend Permission exceeded          | Стоимость UserOperation слишком велика - настройте лимит Per UserOperation.         |
| rejected due to max monthly org Spend Permission                   | Превышен максимальный месячный лимит - свяжитесь с нами, чтобы увеличить ваш лимит. |
| rejected due to max global usd Spend Permission reached            | Превышен настроенный максимальный общий лимит в USD - скорректируйте вашу политику. |
| rejected due to maximum per address transaction count reached | Достигнуто максимальное количество спонсируемых транзакций для адреса отправителя.       |
| rejected due to maximum per address sponsorship reached       | Достигнут максимальный лимит спонсирования в USD для адреса отправителя.                 |
| attestation not found for address                             | У адреса отправителя нет требуемой аттестации (attestation).                             |
| target address not in allowed contracts                       | Список разрешенных контрактов - вызван недопустимый адрес.                               |
| method not in allowed methods                                 | Список разрешенных контрактов - вызван недопустимый метод у разрешенного контракта.      |

## Коды ошибок Bundler

Ниже приведен список распространенных кодов ошибок, возвращаемых Bundler. Обычно они сопровождаются кодом ошибки Entrypoint (определен ниже).

| Ошибка                     | Код    | Описание                                           |
| :------------------------- | :----- | :------------------------------------------------- |
| REJECTED_BY_EP_OR_ACCOUNT  | -32500 | Транзакция была отклонена EP или аккаунтом.        |
| REJECTED_BY_PAYMASTER      | -32501 | Транзакция была отклонена Paymaster.               |
| BANNED_OPCODE              | -32502 | Транзакция содержит запрещенный опкод (opcode).    |
| SHORT_DEADLINE             | -32503 | Срок действия транзакции слишком короткий.         |
| BANNED_OR_THROTTLED_ENTITY | -32504 | Сущность заблокирована или ограничена.             |
| INVALID_ENTITY_STAKE       | -32505 | Ставка сущности недействительна.                   |
| INVALID_AGGREGATOR         | -32506 | Агрегатор недействителен.                          |
| INVALID_SIGNATURE          | -32507 | Подпись транзакции недействительна.                |
| EXECUTION_REVERTED         | -32521 | Выполнение транзакции было отменено (reverted).    |
| INVALID_FIELDS             | -32602 | Транзакция содержит недействительные поля.         |

## Коды ошибок Entrypoint

Ниже приведен список распространенных кодов ошибок, возвращаемых Entry Point.

| Ошибка                           | Описание                                                                                                                                                             |
| :------------------------------- | :------------------------------------------------------------------------------------------------------------------------------------------------------------------- |
| AA10 sender already constructed  | Отправитель уже был создан, поэтому initCode должен быть пустым. Удалите initCode.                                                                               |
| AA13 initCode failed or OOG      | Не удалось создать аккаунт с помощью initCode или закончился газ. Также проверьте поле verificationGasLimit в вашей UserOperation.                               |
| AA14 initCode must return sender | initCode не предоставляет адрес отправителя. Проверьте initCode или фабричный контракт на наличие проблем.                                                       |
| AA15 initCode must create sender | initCode в UserOperation не удалось создать аккаунт. Проверьте initCode или фабричный контракт на наличие проблем.                                               |
| AA20 Account not deployed        | Смарт-аккаунт не развернут, и initCode не был указан. Если это первая транзакция для этого аккаунта, убедитесь, что включен initCode.                            |
| AA21 didn’t pay prefund          | Транзакция была отклонена EP или аккаунтом. Убедитесь, что на аккаунте достаточно ETH для оплаты UserOperation, или что Paymaster настроен правильно.            |
| AA23 reverted (or OOG)           | Подпись UserOperation была отклонена или закончился газ. Проверьте, достаточно ли у вас ETH для газа, или правильно ли настроен Paymaster.                       |
| AA24 Signature error             | Подпись UserOperation недействительна. Проверьте, что хэш UserOperation, адрес entrypoint и идентификатор цепи верны.                                            |
| AA25 Invalid account nonce       | nonce недействителен. UserOperation использует старый нонс или нонс имеет неправильный формат.                                                                   |
| AA40 Over verification gas limit | Превышен лимит газа на верификацию. Проверьте поле verificationGasLimit в вашей UserOperation.                                                                   |
| AA41 Too little verification gas | Верификация UserOperation не завершилась из-за недостаточного газа. Возможно, вам нужно увеличить verificationGasLimit.                                          |
| AA50 PostOp reverted             | Выполнение дополнительной логики EntryPoint привело к откату (revert).                                                                                           |
| AA51 prefund below actualGasCost | Фактическая стоимость UserOperation выше общего количества одобренного газа.                                                                                     |

## Логи запросов

Логи запросов для UserOps можно загрузить на вкладке Logs на странице Paymaster. Эти логи полезны для отладки ошибок или аудита спонсируемых UserOps. Нажмите `Download CSV`, чтобы загрузить CSV-файл с успешными и неудачными запросами.

| Столбец         | Описание                                                                                 |
| :-------------- | :--------------------------------------------------------------------------------------- |
| OrganizationId  | ID вашей организации в Cloud Developer Platform.                                                                     |
| ProjectId       | ID вашего проекта в Cloud Developer Platform.                                                                        |
| Network         | Сеть для запроса. Либо base, либо base-sepolia.                                                                      |
| Status          | Статус запроса. Либо completed, in progress или failed.                                                              |
| UserOpHash      | Хэш UserOperation.                                                                                                   |
| Sender          | Аккаунт, выполняющий UserOperation.                                                                                  |
| Paymaster       | Контракт/сервис, который спонсирует газ для UserOperation (делая транзакции бесплатными для конечного пользователя). |
| TransactionHash | Хэш транзакции, в которую была включена UserOperation.                                                               |
| GasCost         | Стоимость газа в Gwei.                                                                                               |
| GasUsed         | Количество использованного газа * стоимость газа.                                                                    |
| Method          | Метод, вызванный запросом.                                                                                           |
| ErrorCode       | Код ошибки для неудачных запросов.                                                                                   |
| ErrorMessage    | Сообщение об ошибке для неудачных запросов.                                                                          |



