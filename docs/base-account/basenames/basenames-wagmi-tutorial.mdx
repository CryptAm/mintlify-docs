---
title: Basenames + Wagmi Tutorial
slug: /basenames-tutorial-using-wagmi
description: 'Руководство по интеграции Basenames в ваше wagmi/viem приложение'
author: hughescoin
---

# Добавление Basenames в ваше ончейн-приложение

[Basenames] теперь доступны! Но что это такое? Basenames позволяет пользователям регистрировать читаемые человеком имена для своих адресов и служит фундаментальным строительным блоком для ончейн-идентичности. Представьте это как ваш любимый псевдоним в соцсетях, но ещё лучше. Ваш Basename по умолчанию работает в нескольких сетях и принадлежит вам навсегда - никакая платформа не может забрать его у вас (просто не забывайте оплачивать сборы).

Интеграция Basenames в ваше ончейн-приложение улучшает пользовательский опыт, скрывая сложные адреса кошельков. Подобно тому, как домены упрощают IP-адреса, Basenames делают то же самое для адресов кошельков.

В этом руководстве показано, как отображать Basenames от имени ваших пользователей. Мы пройдём через настройку необходимых файлов и конфигураций для прямого взаимодействия с резолвером ENS Basenames. Давайте начнём!

## Цели

К концу этого руководства вы сможете:

- Понять, как работает ончейн-идентичность в сети Base
- Включить использование ончейн-идентичности пользователями в вашем приложении
- Получать метаданные из профиля Basename ваших пользователей

## Шаги

Сначала создайте директорию для хранения ABI (Application Binary Interface) для резолвера ENS Basenames. ABI позволит вашему проекту взаимодействовать со смарт-контрактом, который обрабатывает Basenames.

В папке вашего проекта выполните следующие команды:

```bash
mkdir abis
cd abis
touch L2ResolverAbi.ts
```

Это создаст новую директорию с именем `abis` и файл L2ResolverAbi.ts внутри неё.

Далее добавьте следующий заглушечный код в файл `L2ResolverAbi.ts`:

```typescriptsrc/abis/L2ResolverAbi.ts
export default [
  // Здесь будет информация ABI
] as const;
```

<Tip>
Вам нужно будет заменить комментарий-заглушку на фактический ABI. Вот ссылка на полный [L2ResolverAbi].
</Tip>

Для взаимодействия с блокчейном Base вам нужно обновить конфигурацию wagmi. Это позволит вашему проекту подключаться к сети Base и использовать её возможности.

Обновите ваш файл wagmi.ts следующим образом:

```typescript wagmi.ts
'use client';

import { QueryClient, QueryClientProvider } from '@tanstack/react-query';
import { ReactNode } from 'react';
import { http, createConfig, WagmiProvider } from 'wagmi';
import { base } from 'wagmi/chains';

export const config = createConfig({
  chains: [base],
  transports: {
    [base.id]: http(),
  },
  ssr: true,
});

const queryClient = new QueryClient();

export default function EthereumProviders({ children }: { children: ReactNode }) {
  return (
    <WagmiProvider config={config}>
      <QueryClientProvider client={queryClient}>{children}</QueryClientProvider>
    </WagmiProvider>
  );
}
```

Этот код настраивает ваше приложение для использования сети Base, позволяя проекту взаимодействовать с блокчейном.

Далее мы создадим новую директорию для размещения функций, которые будут разрешать и взаимодействовать с Basenames. Эти функции будут отвечать за получение информации о Basename из блокчейна.

В папке вашего проекта создайте директорию apis и добавьте файл basenames.tsx:

<Note title="Что происходит в коде?">
`convertReverseNodeToBytes()`: Эта функция создаёт обратный узел, чтобы мы могли найти имя по адресу. Каждый адрес получает свою обратную запись в нашем реестре, созданную детерминированным способом.
Вы можете увидеть реализацию `convertReverseNodeToBytes()` в [репозитории OnchainKit]
`BasenameTextRecordKeys`: Метаданные (например, Github, Twitter и т.д.) хранятся как текстовые записи, чтобы мы могли искать их на основе ключа enum.
</Note>

```typescript src/apis/basenames.tsx
import {
  Address,
  ContractFunctionParameters,
  createPublicClient,
  encodePacked,
  http,
  keccak256,
  namehash,
} from 'viem';
import { base, mainnet } from 'viem/chains';
import L2ResolverAbi from '@/abis/L2ResolverAbi';

// Функция для разрешения Basename
export async function getBasename(address: Address) {
  try {
    const addressReverseNode = convertReverseNodeToBytes(address, base.id);
    const basename = await baseClient.readContract({
      abi: L2ResolverAbi,
      address: BASENAME_L2_RESOLVER_ADDRESS,
      functionName: 'name',
      args: [addressReverseNode],
    });
    if (basename) {
      return basename as BaseName;
    }
  } catch (error) {
    // Обработайте ошибку соответствующим образом
    console.error('Error resolving Basename:', error);
  }
}
```

Этот код предоставляет основу для разрешения Basenames с использованием сети Base.

<Tip>
Вы можете найти полную реализацию в полном файле [basenames.tsx].
</Tip>

Теперь, когда необходимые функции на месте, вы можете реализовать функциональность Basenames в вашем приложении. Для этого примера мы изменим файл `page.tsx`, чтобы отображать информацию о Basename на стороне сервера и клиента.

Вот как это настроить:

```typescript src/app/page.tsx
import {
  BasenameTextRecordKeys,
  getBasename,
  getBasenameAvatar,
  getBasenameTextRecord,
} from '@/apis/basenames';
import BasenameDetails from '@/components/BasenameDetails';
import EthereumProviders from '@/contexts/EthereumProviders';
import { useAccount } from 'wagmi';

// shrek.base.eth

const address = '0x8c8F1a1e1bFdb15E7ed562efc84e5A588E68aD73'; // const account = useAccount(); \n address = account?.address;

async function fetchData() {
  const basename = await getBasename(address);

  if (basename === undefined) throw Error('failed to resolve address to name');

  const avatar = await getBasenameAvatar(basename);

  const description = await getBasenameTextRecord(basename, BasenameTextRecordKeys.Description);

  const twitter = await getBasenameTextRecord(basename, BasenameTextRecordKeys.Twitter);

  return {
    basename,
    avatar,
    description,
    twitter,
  };
}

export default async function Home() {
  const data = await fetchData();

  return (
    <EthereumProviders>
      <main className="flex min-h-screen flex-col gap-12 p-24">
        <div className="mb-12">
          <h1 className="mb-4 text-xl">Server-side rendered:</h1>
          <ul className="flex flex-col gap-4">
            <li className="flex flex-col gap-2">
              <span>Address</span>
              <strong>{address}</strong>
            </li>
            <li className="flex flex-col gap-2">
              <span>Basename</span>
              <strong>{data.basename}</strong>
            </li>
            <li className="flex flex-col gap-2">
              <span>Avatar</span>
              <strong>
                <img src={data.avatar} alt={data.basename} width={100} height={100} />
              </strong>
            </li>
            <li className="flex flex-col gap-2">
              <span>Description</span>
              <strong>{data.description}</strong>
            </li>
            <li className="flex flex-col gap-2">
              <span>Twitter</span>
              <strong>{data.twitter}</strong>
            </li>
          </ul>
        </div>
        <div>
          <h1 className="mb-4 text-xl">Client-side rendered:</h1>
          <BasenameDetails address={address} />
        </div>
      </main>
    </EthereumProviders>
  );
}
```

В этом примере компонент Home получает данные Basename и отображает их как в серверно-рендеренной, так и в клиентско-рендеренной секциях. Это позволяет вашему приложению обеспечить бесшовный пользовательский опыт, показывая детали Basename, такие как аватар, описание и связанный Twitter-аккаунт.

## Заключение

Поздравляем! Вы успешно интегрировали Basenames в ваш проект. Настроив необходимый ABI, сконфигурировав ваш wagmi-проект и реализовав пользовательские функции для разрешения и отображения Basenames, вы улучшили пользовательский опыт вашего приложения, сделав адреса кошельков более удобными для пользователей. Теперь ваши пользователи могут наслаждаться персонализированной, узнаваемой ончейн-идентичностью в сети Base. Продолжайте исследовать и создавать, чтобы открыть ещё больше возможностей с Basenames!

[Basenames]: https://www.base.org/names/
[OnchainKit]: https://onchainkit.xyz/
[L2ResolverAbi]: https://gist.github.com/hughescoin/adf1c90b67cd9b2b913b984a2cc98de9
[basenames.tsx]: https://gist.github.com/hughescoin/95b680619d602782396fa954e981adae
[OnchainKit repo]: https://github.com/coinbase/onchainkit/blob/main/src/identity/utils/convertReverseNodeToBytes.ts

