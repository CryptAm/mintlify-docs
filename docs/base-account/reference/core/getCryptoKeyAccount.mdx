---
title: "getCryptoKeyAccount"
description: "Получить текущий криптографический ключ аккаунта, связанный с сессией пользователя"
---

Определено в [Base Account SDK](https://github.com/base/account-sdk)



## Параметры

Эта функция не принимает параметров.

## Возвращает

<ResponseField name="result" type="CryptoKeyAccountResult">
Объект, содержащий информацию о криптографическом ключе аккаунта пользователя, или `null`, если его не существует.

<Expandable title="Свойства CryptoKeyAccountResult">
<ResponseField name="account" type="WebAuthnAccount | LocalAccount | null">
Объект криптографического ключа аккаунта пользователя или `null`, если недоступен.

<Expandable title="Свойства WebAuthnAccount">

<ResponseField name="publicKey" type="string">
Публичный ключ, связанный с аккаунтом.
</ResponseField>

<ResponseField name="type" type="string">
Идентификатор типа аккаунта. Значение: "webauthn"
</ResponseField>
</Expandable>

<Expandable title="Свойства LocalAccount">
<ResponseField name="address" type="string">
Адрес Ethereum аккаунта (42-символьная шестнадцатеричная строка, начинающаяся с 0x).
</ResponseField>

<ResponseField name="publicKey" type="string">
Публичный ключ, связанный с аккаунтом.
</ResponseField>

<ResponseField name="type" type="string">
Идентификатор типа аккаунта. Значение: "local"
</ResponseField>
</Expandable>
</ResponseField>
</Expandable>
</ResponseField>

<RequestExample>
```typescript Basic Usage
import { getCryptoKeyAccount } from '@base-org/account';

const cryptoAccount = await getCryptoKeyAccount();
if (cryptoAccount?.account) {
  console.log('Account address:', cryptoAccount.account.address);
}
```

```typescript Account Verification
const cryptoAccount = await getCryptoKeyAccount();

if (!cryptoAccount?.account) {
  console.log('No account found - user needs to sign in');
  return null;
}

const { account } = cryptoAccount;
console.log('Account type:', account.type);
```
</RequestExample>

<ResponseExample>
```typescript Success Response (WebAuthn Account)
{
  account: {
    address: "0xd46e8dd67c5d32be8058bb8eb970870f07244567",
    publicKey: "0x04a1b2c3d4e5f6...",
    type: "webauthn"
  }
}
```

```typescript Success Response (Local Account)
{
  account: {
    address: "0x742d35Cc4Bf53E0e6C42E5d9F0A8D2F6D8A8B7C9",
    publicKey: "0x04b2c3d4e5f6a7...",
    type: "local"
  }
}
```

```typescript Success Response (No Account)
{
  account: null
}
```
</ResponseExample>

## Обработка ошибок

| Код  | Сообщение | Описание    |
| ---- | --------- | ----------- |
| 4001 | User denied account access | Пользователь отклонил запрос доступа к аккаунту |
| 4100 | SDK not initialized | Base Account SDK не был правильно инициализирован |
| 4200 | Session expired | Сессия пользователя истекла, требуется повторное подключение |
| 4300 | Account unavailable | Аккаунт временно недоступен |

<Warning>
Всегда проверяйте существование аккаунта перед его использованием, так как пользователь может быть не подключен или отключиться.
</Warning>

## Управление состоянием аккаунта

```typescript
import { getCryptoKeyAccount } from '@base-org/account';

class AccountManager {
  private currentAccount: WebAuthnAccount | LocalAccount | null = null;
  
  async initialize() {
    const cryptoAccount = await getCryptoKeyAccount();
    this.currentAccount = cryptoAccount?.account || null;
    
    return this.isConnected();
  }
  
  isConnected(): boolean {
    return !!this.currentAccount;
  }
  
  getAddress(): string | null {
    return this.currentAccount?.address || null;
  }
  
  getAccountType(): 'webauthn' | 'local' | null {
    return this.currentAccount?.type || null;
  }
  
  async refresh() {
    const cryptoAccount = await getCryptoKeyAccount();
    const newAccount = cryptoAccount?.account;
    
    // Проверить, изменился ли аккаунт
    if (newAccount?.address !== this.currentAccount?.address) {
      console.log('Account changed:', newAccount?.address);
      this.currentAccount = newAccount;
      return true;
    }
    
    return false;
  }
}
```

## Интеграция с провайдером

```typescript
import { getCryptoKeyAccount, createBaseAccountSDK } from '@base-org/account';

async function initializeApp() {
  const sdk = createBaseAccountSDK({
    appName: 'My App',
    appLogoUrl: 'https://example.com/logo.png',
    appChainIds: [8453], // Base mainnet
  });
  
  // Проверить текущий статус аккаунта
  const cryptoAccount = await getCryptoKeyAccount();
  
  if (cryptoAccount?.account) {
    console.log('User is already connected:', cryptoAccount.account.address);
    
    // Получить провайдер для транзакций
    const provider = sdk.getProvider();
    
    return {
      sdk,
      provider,
      account: cryptoAccount.account,
      isConnected: true
    };
  } else {
    console.log('User needs to connect');
    
    return {
      sdk,
      provider: null,
      account: null,
      isConnected: false
    };
  }
}
```

## Проверка аккаунта

```typescript
async function verifyAccountAccess() {
  const cryptoAccount = await getCryptoKeyAccount();
  
  if (!cryptoAccount?.account) {
    throw new Error('No account available');
  }
  
  const { account } = cryptoAccount;
  
  // Проверить, что аккаунт имеет необходимые свойства
  if (!account.address || !account.publicKey) {
    throw new Error('Invalid account data');
  }
  
  // Проверить формат адреса
  if (!/^0x[a-fA-F0-9]{40}$/.test(account.address)) {
    throw new Error('Invalid address format');
  }
  
  return account;
}
```

import PolicyBanner from "/snippets/PolicyBanner.mdx";

<PolicyBanner />
