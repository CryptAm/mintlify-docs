---
title: "wallet_getCallsStatus"
description: "Получить статус пакета вызовов, отправленных через wallet_sendCalls"
---

Определено в [EIP-5792](https://eips.ethereum.org/EIPS/eip-5792)

<Info>
Возвращает статус пакета вызовов, отправленного через `wallet_sendCalls`. Этот метод позволяет приложениям отслеживать статус выполнения и получать квитанции транзакций для пакетных операций.
</Info>

## Параметры

<ParamField body="callsId" type="string" required>
Идентификатор пакета вызовов, возвращенный предыдущим запросом `wallet_sendCalls`.
</ParamField>

## Возвращает

<ResponseField name="result" type="object">
Информация о статусе пакета вызовов.

<Expandable title="Свойства CallsStatus">
<ResponseField name="version" type="string">
Используемая версия API. В настоящее время "1.0".
</ResponseField>

<ResponseField name="chainId" type="string">
Идентификатор цепи (chainID) в шестнадцатеричном формате (hex).
</ResponseField>

<ResponseField name="id" type="string">
Идентификатор пакета вызовов.
</ResponseField>

<ResponseField name="status" type="number">
Код статуса, указывающий текущее состояние пакета:
- **1xx (В ожидании)**: 100 = Пакет получен, но не завершен в блокчейне
- **2xx (Подтвержден)**: 200 = Пакет включен в блокчейн без откатов (reverts)
- **4xx (Ошибки вне блокчейна)**: 400 = Пакет завершился неудачей, кошелек не будет повторять
- **5xx (Ошибки в блокчейне)**: 500 = Пакет полностью откатился
- **6xx (Частичные ошибки)**: 600 = Пакет частично откатился
</ResponseField>

<ResponseField name="atomic" type="boolean">
Указывает, выполнил ли кошелек вызовы атомарно. Если `true`, все вызовы были выполнены в одной транзакции. Если `false`, вызовы были выполнены в нескольких транзакциях.
</ResponseField>

<ResponseField name="receipts" type="Receipt[]">
Квитанции транзакций для пакета вызовов. Структура зависит от поля `atomic`:
- Если `atomic` равно `true`: Одиночная квитанция или массив квитанций для пакетной транзакции
- Если `atomic` равно `false`: Массив квитанций для всех транзакций, содержащих вызовы пакета

<Expandable title="Свойства Receipt">
<ResponseField name="logs" type="Log[]">
Логи, сгенерированные вызовами. Для смарт-контрактных кошельков включают только логи, относящиеся к конкретным вызовам.
</ResponseField>

<ResponseField name="status" type="'0x1' | '0x0'">
Статус транзакции: `0x1` для успеха, `0x0` для неудачи.
</ResponseField>

<ResponseField name="blockHash" type="string">
Хэш блока, содержащего эти вызовы.
</ResponseField>

<ResponseField name="blockNumber" type="string">
Номер блока, содержащего эти вызовы (hex).
</ResponseField>

<ResponseField name="gasUsed" type="string">
Количество газа, использованного этими вызовами (hex).
</ResponseField>

<ResponseField name="transactionHash" type="string">
Хэш транзакции, содержащей эти вызовы.
</ResponseField>
</Expandable>
</ResponseField>

<ResponseField name="capabilities" type="object">
Опциональные метаданные, специфичные для возможностей.
</ResponseField>
</Expandable>
</ResponseField>

## Пример использования

<RequestExample>
```json Request
{
  "id": 1,
  "jsonrpc": "2.0",
  "method": "wallet_getCallsStatus",
  "params": ["0xe670ec64341771606e55d6b4ca35a1a6b75ee3d5145a99d05921026d1527331"]
}
```

```typescript SDK Usage
import { createBaseAccountSDK } from '@base-org/account';

const provider = createBaseAccountSDK().getProvider();

// Получить статус пакета, отправленного через wallet_sendCalls
const callsId = "0xe670ec64341771606e55d6b4ca35a1a6b75ee3d5145a99d05921026d1527331"; 

const status = await provider.request({
  method: 'wallet_getCallsStatus',
  params: [callsId]
});

console.log('Batch status:', status.status);
console.log('Atomic execution:', status.atomic);
console.log('Receipts:', status.receipts);
```
</RequestExample>

<ResponseExample>
```json Successful Batch (Atomic)
{
  "id": 1,
  "jsonrpc": "2.0",
  "result": {
    "version": "1.0",
    "chainId": "0x2105",
    "id": "0xe670ec64341771606e55d6b4ca35a1a6b75ee3d5145a99d05921026d1527331",
    "status": 200,
    "atomic": true,
    "receipts": [
      {
        "logs": [
          {
            "address": "0xa922b54716264130634d6ff183747a8ead91a40b",
            "topics": ["0x5a2a90727cc9d000dd060b1132a5c977c9702bb3a52afe360c9c22f0e9451a68"],
            "data": "0xabcd"
          }
        ],
        "status": "0x1",
        "blockHash": "0xf19bbafd9fd0124ec110b848e8de4ab4f62bf60c189524e54213285e7f540d4a",
        "blockNumber": "0xabcd",
        "gasUsed": "0xdef",
        "transactionHash": "0x9b7bb827c2e5e3c1a0a44dc53e573aa0b3af3bd1f9f5ed03071b100bb039eaff"
      }
    ]
  }
}
```

```json Pending Batch
{
  "id": 1,
  "jsonrpc": "2.0",
  "result": {
    "version": "1.0",
    "chainId": "0x2105",
    "id": "0xe670ec64341771606e55d6b4ca35a1a6b75ee3d5145a99d05921026d1527331",
    "status": 100,
    "atomic": true,
    "receipts": []
  }
}
```

```json Failed Batch
{
  "id": 1,
  "jsonrpc": "2.0",
  "result": {
    "version": "1.0",
    "chainId": "0x2105",
    "id": "0xe670ec64341771606e55d6b4ca35a1a6b75ee3d5145a99d05921026d1527331",
    "status": 500,
    "atomic": true,
    "receipts": [
      {
        "logs": [],
        "status": "0x0",
        "blockHash": "0xf19bbafd9fd0124ec110b848e8de4ab4f62bf60c189524e54213285e7f540d4a",
        "blockNumber": "0xabcd",
        "gasUsed": "0xabc",
        "transactionHash": "0x9b7bb827c2e5e3c1a0a44dc53e573aa0b3af3bd1f9f5ed03071b100bb039eaff"
      }
    ]
  }
}
```
</ResponseExample>

## Справочник кодов статуса

| Код  | Категория | Значение |
|------|-----------|----------|
| 100 | В ожидании | Пакет получен, но не завершен в блокчейне |
| 200 | Успех	 | Пакет включен в блокчейн без откатов (reverts) |
| 400 | Ошибка вне блокчейна | Пакет завершился неудачей, кошелек не будет повторять |
| 500 | Ошибка в блокчейне | Пакет полностью откатился |
| 600 | Частичная ошибка | Пакет частично откатился, некоторые изменения могут быть в блокчейне |

## Обработка ошибок

| Код  | Сообщение | Описание    |
| ---- | --------- | ----------- |
| -32602 | Invalid params | Некорректный идентификатор пакета вызовов |
| 4100 | Method not supported | Кошелек не поддерживает wallet_getCallsStatus |
| 4200 | Calls not found | Не найден пакет с указанным идентификатором |

## Использование с wallet_sendCalls

Этот метод предназначен для работы с пакетами, отправленными через `wallet_sendCalls`:

```typescript
// Отправить пакет вызовов
const callsId = await provider.request({
  method: 'wallet_sendCalls',
  params: [{
    version: '1.0',
    chainId: '0x2105',
    from: userAddress,
    calls: [
      { to: '0x...', value: '0x0', data: '0x...' },
      { to: '0x...', value: '0x0', data: '0x...' }
    ]
  }]
});

// Опрашивать обновления статуса
const checkStatus = async () => {
  const status = await provider.request({
    method: 'wallet_getCallsStatus',
    params: [callsId]
  });
  
  if (status.status === 200) {
    console.log('Batch completed successfully!');
    console.log('Transaction receipts:', status.receipts);
  } else if (status.status === 100) {
    console.log('Batch still pending...');
    setTimeout(checkStatus, 2000); // Проверить снова через 2 секунды
  } else {
    console.error('Batch failed with status:', status.status);
  }
};

checkStatus();
```

<Warning>
Структура квитанций варьируется в зависимости от того, был ли пакет выполнен атомарно. Всегда проверяйте поле `atomic`, чтобы правильно интерпретировать массив квитанций.
</Warning>

<Info>
Этот метод следует стандарту EIP-5792 для пакетных операций кошелька. Не все кошельки могут поддерживать этот метод - сначала проверьте возможности кошелька.
</Info>

import PolicyBanner from "/snippets/PolicyBanner.mdx";

<PolicyBanner />
