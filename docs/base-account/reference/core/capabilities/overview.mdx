---
title: "Обзор возможностей"
description: "Поймите, как использовать возможности Base Account с методами wallet_connect и wallet_sendCalls"
---

Base Account поддерживает различные возможности, которые расширяют функциональность за пределы стандартных операций кошелька. Возможности (capabilities) - это флаги функций, которые указывают, какую дополнительную функциональность кошелек поддерживает для конкретных цепочек и аккаунтов.

## Основные концепции

Возможности обнаруживаются с помощью `wallet_getCapabilities` и используются через методы `wallet_connect` и `wallet_sendCalls`. Каждая возможность зависит от цепочки и может иметь разную доступность в зависимости от типа аккаунта.

### Паттерн обнаружения

```typescript
// Проверить, какие возможности доступны
const capabilities = await provider.request({
  method: 'wallet_getCapabilities',
  params: [userAddress]
});

// Проверить конкретную возможность для Base mainnet
const baseCapabilities = capabilities["0x2105"]; // Base mainnet chain ID
```

## Доступные возможности

| Возможность | Метод | Описание    |
|-----------|---------|-------------|
| [signInWithEthereum](/base-account/reference/core/capabilities/signInWithEthereum) | `wallet_connect` | Аутентификация SIWE |
| [auxiliaryFunds](/base-account/reference/core/capabilities/auxiliaryFunds) | `wallet_sendCalls` | MagicSpend - использование балансов Coinbase в блокчейне |
| [atomic](/base-account/reference/core/capabilities/atomic) | `wallet_sendCalls` | Атомарные пакетные транзакции |
| [paymasterService](/base-account/reference/core/capabilities/paymasterService) | `wallet_sendCalls` | Бесплатные транзакции |
| [flowControl](/base-account/reference/core/capabilities/flowControl) | `wallet_sendCalls` | Управление потоком |
| [datacallback](/base-account/reference/core/capabilities/datacallback) | `wallet_sendCalls` | Обратный вызов данных |

## Использование с wallet_connect

Метод `wallet_connect` поддерживает возможности для подключения и аутентификации:

### Базовое подключение

```typescript
// Простое подключение без возможностей
const result = await provider.request({
  method: 'wallet_connect',
  params: [{
    version: '1'
  }]
});
```

### Аутентификация с signInWithEthereum

```typescript
// Генерируем nonce для безопасности
const nonce = window.crypto.randomUUID().replace(/-/g, '');

const { accounts } = await provider.request({
  method: 'wallet_connect',
  params: [{
    version: '1',
    capabilities: {
      signInWithEthereum: { 
        nonce, 
        chainId: '0x2105' // Base Mainnet
      }
    }
  }]
});

// Извлекаем данные аутентификации
const { address } = accounts[0];
const { message, signature } = accounts[0].capabilities.signInWithEthereum;

// Проверяем подпись на вашем бэкенде
await fetch('/auth/verify', {
  method: 'POST',
  headers: { 'Content-Type': 'application/json' },
  body: JSON.stringify({ address, message, signature })
});
```

## Использование с wallet_sendCalls

Метод `wallet_sendCalls` поддерживает возможности, связанные с транзакциями:

### Базовая транзакция

```typescript
// Простая транзакция без возможностей
const result = await provider.request({
  method: 'wallet_sendCalls',
  params: [{
    version: '1.0',
    chainId: '0x2105',
    from: userAddress,
    calls: [{
      to: '0x...',
      value: '0x0',
      data: '0x...'
    }]
  }]
});
```

### Бесплатные транзакции с Paymaster

```typescript
await provider.request({
  method: 'wallet_sendCalls',
  params: [{
    version: '1.0',
    chainId: '0x2105',
    from: userAddress,
    calls: [{
      to: contractAddress,
      value: '0x0',
      data: encodedFunctionCall
    }],
    capabilities: {
      paymasterService: {
        url: "https://paymaster.base.org/api/v1/sponsor"
      }
    }
  }]
});
```

### Атомарные пакетные транзакции

```typescript
await provider.request({
  method: 'wallet_sendCalls',
  params: [{
    version: '1.0',
    chainId: '0x2105',
    from: userAddress,
    atomicRequired: true, // Требовать атомарное выполнение
    calls: [
      {
        to: tokenAddress,
        value: '0x0',
        data: approveCallData
      },
      {
        to: dexAddress,
        value: '0x0',
        data: swapCallData
      }
    ]
  }]
});
```

## Паттерны обнаружения возможностей

### Проверка одной возможности

```typescript
async function checkAuxiliaryFunds(address: string): Promise<boolean> {
  try {
    const capabilities = await provider.request({
      method: 'wallet_getCapabilities',
      params: [address]
    });

    return capabilities["0x2105"]?.auxiliaryFunds?.supported || false;
  } catch (error) {
    console.error('Failed to check capabilities:', error);
    return false;
  }
}
```

### Проверка нескольких возможностей

```typescript
async function getWalletCapabilities(address: string) {
  const capabilities = await provider.request({
    method: 'wallet_getCapabilities',
    params: [address]
  });

  const baseCapabilities = capabilities["0x2105"] || {};

  return {
    hasAuxiliaryFunds: baseCapabilities.auxiliaryFunds?.supported || false,
    hasAtomicBatch: baseCapabilities.atomic?.supported === "supported",
    hasPaymaster: !!baseCapabilities.paymasterService?.supported,
    canAuthenticate: true // signInWithEthereum всегда доступен с wallet_connect
  };
}
```

## Руководства по конкретным возможностям

Для подробной информации о каждой возможности:

- [signInWithEthereum](/base-account/reference/core/capabilities/signInWithEthereum) - Аутентификация SIWE
- [auxiliaryFunds](/base-account/reference/core/capabilities/auxiliaryFunds) - Интеграция MagicSpend
- [atomic](/base-account/reference/core/capabilities/atomic) - Атомарные пакетные транзакции
- [paymasterService](/base-account/reference/core/capabilities/paymasterService) - Бесплатные транзакции

## Связанные методы

- [`wallet_getCapabilities`](/base-account/reference/core/provider-rpc-methods/wallet_getCapabilities) - Обнаружение доступных возможностей
- [`wallet_connect`](/base-account/reference/core/provider-rpc-methods/wallet_connect) - Подключение с возможностями
- [`wallet_sendCalls`](/base-account/reference/core/provider-rpc-methods/wallet_sendCalls) - Выполнение транзакций с возможностями

import PolicyBanner from "/snippets/PolicyBanner.mdx";

<PolicyBanner />
