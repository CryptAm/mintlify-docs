---
title: "createBaseAccountSDK"
description: "Создание экземпляра SDK Base Account с EIP-1193 совместимым провайдером"
---

Определено в [Base Account SDK](https://github.com/base/account-sdk)

<Info>
Создает экземпляр SDK Base Account, который предоставляет EIP-1193 совместимый Ethereum-провайдер и дополнительную функциональность управления аккаунтами. Это основная точка входа для интеграции Base Account в ваше приложение.
</Info>

## Параметры

<ParamField body="params" type="CreateProviderOptions" required>
Опции конфигурации для создания экземпляра

<Expandable title="Свойства CreateProviderOptions">
<ParamField body="appName" type="string">
Название вашего приложения. По умолчанию "App", если не указано.
</ParamField>

<ParamField body="appLogoUrl" type="string">
URL логотипа вашего приложения. Используется в интерфейсе кошелька. По умолчанию пустая строка, если не указано.
</ParamField>

<ParamField body="appChainIds" type="number[]">
Массив идентификаторов цепочек (chain IDs), которые поддерживает ваше приложение. По умолчанию пустой массив, если не указано.
</ParamField>

<ParamField body="preference" type="Preference">
Опциональные предпочтения для поведения SDK.

<Expandable title="Свойства Preference">
<ParamField body="walletUrl" type="string">
Пользовательский URL кошелька для переопределения. Используйте только при переопределении URL кошелька по умолчанию пользовательским окружением.
</ParamField>

<ParamField body="attribution" type="Attribution">
Конфигурация атрибуции для транзакций Smart Wallet.

<Expandable title="Свойства Attribution">
<ParamField body="auto" type="boolean">
Если true, Smart Wallet будет генерировать 16-байтовую hex-строку из origin приложения.
</ParamField>

<ParamField body="dataSuffix" type="`0x${string}`">
Пользовательская 16-байтовая hex-строка, добавляемая к initCode и calldata executeBatch. Не может использоваться с `auto: true`.
</ParamField>
</Expandable>
</ParamField>

<ParamField body="telemetry" type="boolean">
Включить ли функциональную телеметрию. По умолчанию `true`.
</ParamField>
</Expandable>
</ParamField>

<ParamField body="subAccounts" type="SubAccountOptions">
Опции конфигурации субаккаунтов.

<Expandable title="Свойства SubAccountOptions">
<ParamField body="creation" type="'on-connect' | 'manual'">
Управляет созданием субаккаунтов. По умолчанию `'manual'`.

- `'on-connect'`: Автоматически создает субаккаунт при подключении к кошельку (автоматически добавляет `capability addSubAccount` к `wallet_connect`)
- `'manual'`: Требует явного вызова `wallet_addSubAccount` для создания субаккаунта
</ParamField>

<ParamField body="defaultAccount" type="'sub' | 'universal'">
Управляет тем, какой аккаунт используется по умолчанию, когда аккаунт не указан. По умолчанию `'universal'`.

- `'sub'`: Субаккаунт является аккаунтом по умолчанию (первый в массиве accounts)
- `'universal'`: Универсальный аккаунт является аккаунтом по умолчанию (первый в массиве accounts)
</ParamField>

<ParamField body="funding" type="'spend-permissions' | 'manual'">
Управляет тем, как субаккаунты пополняются. По умолчанию `'spend-permissions'`.

- `'spend-permissions'`: Маршрутизирует через универсальный аккаунт, если нет разрешений на траты, автоматически обрабатывает ошибки недостаточного баланса. Узнайте больше в [Автоматические Разрешения на траты (Auto Spend Permissions)](/base-account/improve-ux/sub-accounts#auto-spend-permissions)
- `'manual'`: Прямое выполнение из субаккаунта без автоматических откатов (fallbacks)
</ParamField>

<ParamField body="toOwnerAccount" type="ToOwnerAccountFn">
Функция, возвращающая аккаунт владельца для подписи транзакций субаккаунта.

<Expandable title="Сигнатура ToOwnerAccountFn">
```typescript
type ToOwnerAccountFn = () => Promise<{ account: OwnerAccount | null; }>
```

Где `OwnerAccount` - это объединенный тип (union type):
- `LocalAccount` (из viem) - Локальный аккаунт с приватным ключом
- `WebAuthnAccount` (из viem) - Аккаунт на основе WebAuthn для аутентификации пасскей
</Expandable>
</ParamField>
</Expandable>
</ParamField>

<ParamField body="paymasterUrls" type="Record<number, string>">
Отображение идентификаторов цепочек (chain IDs) на URL плательщиков газа для бесплатных транзакций.
</ParamField>
</Expandable>
</ParamField>

## Возвращает

<ResponseField name="sdk" type="BaseAccountSDK">
Экземпляр SDK с возможностями провайдера и управления субаккаунтами.

<Expandable title="Свойства BaseAccountSDK">
<ResponseField name="getProvider" type="() => ProviderInterface">
Возвращает EIP-1193 совместимый Ethereum-провайдер, который может использоваться с web3-библиотеками, такими как Viem, Wagmi и Web3.js.
</ResponseField>

<ResponseField name="subAccount" type="SubAccountManager">
Методы управления субаккаунтами.

<Expandable title="Свойства SubAccountManager">
<ResponseField name="create" type="(account: AddSubAccountAccount) => Promise<SubAccount>">
Создает новый субаккаунт.
</ResponseField>

<ResponseField name="get" type="() => Promise<SubAccount | null>">
Получает информацию о текущем субаккаунте.
</ResponseField>

<ResponseField name="addOwner" type="(params: AddOwnerParams) => Promise<string>">
Добавляет владельца к субаккаунту.
</ResponseField>

<ResponseField name="setToOwnerAccount" type="(fn: ToOwnerAccountFn) => void">
Устанавливает функцию для определения аккаунта владельца. Функция должна возвращать Promise, разрешающийся в объект со свойством `account`, которое является либо `LocalAccount`, `WebAuthnAccount`, либо `null`.
</ResponseField>
</Expandable>
</ResponseField>
</Expandable>
</ResponseField>

<RequestExample>
```typescript Basic Setup
import { createBaseAccountSDK } from '@base-org/account';
import { base } from 'viem/chains';

const sdk = createBaseAccountSDK({
  appName: 'My DApp',
  appLogoUrl: 'https://mydapp.com/logo.png',
  appChainIds: [base.id],
});

const provider = sdk.getProvider();
```

```typescript Advanced Configuration
import { createBaseAccountSDK } from '@base-org/account';
import { base, baseSepolia } from 'viem/chains';

const sdk = createBaseAccountSDK({
  appName: 'My Advanced DApp',
  appLogoUrl: 'https://mydapp.com/logo.png',
  appChainIds: [base.id, baseSepolia.id],
  preference: {
    attribution: {
      auto: true
    },
    telemetry: true
  },
  subAccounts: {
    creation: 'on-connect', // Автоматически создавать субаккаунт при подключении
    defaultAccount: 'sub', // Использовать субаккаунт по умолчанию
    funding: 'spend-permissions', // Автоматически обрабатывать пополнение
    toOwnerAccount: async () => ({ 
      account: cryptoAccount?.account || null 
    })
  },
  paymasterUrls: {
    [base.id]: 'https://paymaster.base.org',
    [baseSepolia.id]: 'https://paymaster.base-sepolia.org'
  }
});
```

```typescript With Sub-Accounts (Manual Creation)
import { createBaseAccountSDK } from '@base-org/account';

const sdk = createBaseAccountSDK({
  appName: 'Sub-Account App',
  appChainIds: [8453],
  subAccounts: {
    creation: 'manual', // Явно создавать субаккаунты, когда это необходимо
    defaultAccount: 'universal', // Универсальный аккаунт используется по умолчанию
    funding: 'spend-permissions', // Автоматически обрабатывать недостаточный баланс
    toOwnerAccount: async () => {
      // Возвращает аккаунт владельца, который будет подписывать транзакции субаккаунта
      // mainAccount должен быть LocalAccount или WebAuthnAccount из viem
      return { account: mainAccount || null };
    }
  }
});

// Вручную создаем субаккаунт, когда это необходимо
const subAccount = await sdk.subAccount.create({
  type: 'create',
  keys: [{
    type: 'p256',
    publicKey: '0x...'
  }]
});
```

```typescript With Auto-Created Sub-Accounts
import { createBaseAccountSDK } from '@base-org/account';

const sdk = createBaseAccountSDK({
  appName: 'Auto Sub-Account App',
  appChainIds: [8453],
  subAccounts: {
    creation: 'on-connect', // Автоматически создавать при подключении кошелька
    defaultAccount: 'sub', // Субаккаунт используется по умолчанию
    funding: 'spend-permissions', // Автоматически обрабатывать недостаточный баланс
    toOwnerAccount: async () => {
      return { account: mainAccount || null };
    }
  }
});

// Субаккаунт автоматически создается при подключении
const provider = sdk.getProvider();
await provider.request({ method: 'eth_requestAccounts' });

// Субаккаунт автоматически доступен
const subAccount = await sdk.subAccount.get();
```
</RequestExample>

## Примеры интеграции

### С Viem

```typescript
import { createWalletClient, custom } from 'viem';
import { base } from 'viem/chains';
import { createBaseAccountSDK } from '@base-org/account';

const sdk = createBaseAccountSDK({
  appName: 'Viem Integration',
  appChainIds: [base.id]
});

const provider = sdk.getProvider();

const client = createWalletClient({
  chain: base,
  transport: custom(provider)
});
```

### С Wagmi

```typescript
import { createConfig, custom } from 'wagmi';
import { base } from 'wagmi/chains';
import { createBaseAccountSDK } from '@base-org/account';

const sdk = createBaseAccountSDK({
  appName: 'Wagmi Integration',
  appChainIds: [base.id]
});

const provider = sdk.getProvider();

const config = createConfig({
  chains: [base],
  transports: {
    [base.id]: custom(provider),
  },
});
```

## Параметры конфигурации

### Конфигурация субаккаунтов

Настройте поведение субаккаунтов с помощью трех независимых опций:

```typescript
const sdk = createBaseAccountSDK({
  appName: 'My App',
  appChainIds: [8453],
  subAccounts: {
    creation: 'on-connect' | 'manual',              // Когда создавать
    defaultAccount: 'sub' | 'universal',             // Какой используется по умолчанию
    funding: 'spend-permissions' | 'manual',         // Как финансировать транзакции
    toOwnerAccount: async () => ({ account })        // Владелец для подписи
  }
});
```

**Распространенные конфигурации:**

```typescript
// Наиболее бесшовный UX: Автосоздание, использование субаккаунта по умолчанию, автофинансирование
subAccounts: {
  creation: 'on-connect',
  defaultAccount: 'sub',
  funding: 'spend-permissions'
}

// Ручное управление: Создание по необходимости, универсальный аккаунт по умолчанию, автофинансирование
subAccounts: {
  creation: 'manual',
  defaultAccount: 'universal',
  funding: 'spend-permissions'
}

// Полное ручное управление: Полный контроль разработчика
subAccounts: {
  creation: 'manual',
  defaultAccount: 'universal',
  funding: 'manual'
}
```

### Атрибуция

Настройте атрибуцию транзакций для аналитики и отслеживания:

```typescript
// Автогенерация атрибуции из origin приложения
const sdk = createBaseAccountSDK({
  appName: 'My App',
  preference: {
    attribution: { auto: true }
  }
});

// Пользовательские данные атрибуции
const sdk = createBaseAccountSDK({
  appName: 'My App',
  preference: {
    attribution: { dataSuffix: '0x1234567890123456789012345678901234567890' }
  }
});
```

### Интеграция с Paymaster

Включите бесплатные транзакции с URL плательщиков газа:

```typescript
const sdk = createBaseAccountSDK({
  appName: 'Gasless App',
  appChainIds: [8453, 84532],
  paymasterUrls: {
    8453: 'https://paymaster.base.org/api/v1/sponsor',
    84532: 'https://paymaster.base-sepolia.org/api/v1/sponsor'
  }
});
```

## Обработка ошибок

Инициализация SDK является синхронной и будет проверять предпочтения во время создания:

```typescript
try {
  const sdk = createBaseAccountSDK({
    appName: 'My App',
    appChainIds: [8453],
    subAccounts: {
      toOwnerAccount: invalidFunction // Вызовет ошибку валидации
    }
  });
} catch (error) {
  console.error('SDK initialization failed:', error);
}
```

## Поддержка TypeScript

SDK полностью типизирован для разработки на TypeScript:

```typescript
import type { 
  CreateProviderOptions, 
  BaseAccountSDK,
  ProviderInterface,
  ToOwnerAccountFn 
} from '@base-org/account';
import { LocalAccount } from 'viem';

const toOwnerAccount: ToOwnerAccountFn = async () => {
  // Ваша логика получения аккаунта владельца
  const ownerAccount: LocalAccount | null = getOwnerAccount();
  return { account: ownerAccount };
};

const options: CreateProviderOptions = {
  appName: 'Typed App',
  appChainIds: [8453],
  subAccounts: {
    toOwnerAccount
  }
};

const sdk: BaseAccountSDK = createBaseAccountSDK(options);
const provider: ProviderInterface = sdk.getProvider();
```

<Warning>
SDK автоматически управляет валидацией Cross-Origin-Opener-Policy и инициализацией телеметрии. Убедитесь, что заголовки вашего приложения разрешают всплывающие окна, если используется интерфейс кошелька по умолчанию.
</Warning>

<Info>
Функция `createBaseAccountSDK` является основной точкой входа для интеграции Base Account. Она предоставляет как стандартный EIP-1193 провайдер, так и расширенные функции, такие как управление субаккаунтами и бесплатные транзакции.
</Info>

import PolicyBanner from "/snippets/PolicyBanner.mdx";

<PolicyBanner />
