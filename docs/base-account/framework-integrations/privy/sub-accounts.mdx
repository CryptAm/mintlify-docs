---
title: "Субаккаунты"
description: "Создавайте и управляйте привязанными к приложению кошельковыми аккаунтами с помощью Base Account"
---

import { GithubRepoCard } from "/snippets/GithubRepoCard.mdx";

Узнайте, как создавать и управлять субаккаунтами, которые предоставляют привязанные к приложению кошельковые аккаунты, встроенные непосредственно в ваше приложение.

## Обзор

Субаккаунты позволяют создавать выделенные кошельковые аккаунты для ваших пользователей в рамках вашего приложения.
Эти аккаунты управляются основным Base Account пользователя и обеспечивают улучшенный пользовательский опыт,
поскольку взаимодействие пользователя не вызывает запросов passkey или всплывающих окон.

Пользователи могут управлять всеми своими субаккаунтами на [account.base.app](https://account.base.app).

<Note>
Если вы хотите увидеть работающую демонстрацию субаккаунтов, ознакомьтесь с нашей [демонстрацией субаккаунтов](https://sub-accounts-fc.vercel.app).
</Note>

### Что вы получите

К концу этого руководства вы сможете:

- Понять, как субаккаунты работают с Base Account
- Создавать новые субаккаунты для пользователей
- Получать и управлять существующими субаккаунтами
- Реализовать субаккаунты в вашем проекте с Privy

Фрагменты кода в этом руководстве основаны на следующем примере проекта:

<GithubRepoCard
  title="Шаблон Base Account Privy"
  githubUrl="https://github.com/base/base-account-privy"
/>

## Настройка

Следуйте руководству [настройки](/base-account/framework-integrations/privy/setup), чтобы настроить Privy с Base Account.

## Реализация

### Настройка компонента

<CodeGroup>
```tsx Sub Accounts Component (components/sections/sub-accounts.tsx) expandable
"use client";

import { useState, useMemo } from "react";
import { useWallets } from "@privy-io/react-auth";

const SubAccounts = () => {
  const { wallets } = useWallets();
  const [subAccounts, setSubAccounts] = useState<
    {
      address: string;
      factory: string;
      factoryData: string;
    }[]
  >([]);
  const [isLoading, setIsLoading] = useState(false);

  // Находим кошелек Base Account
  const baseAccount = useMemo(() => {
    return wallets.find((wallet) => wallet.walletClientType === 'base_account');
  }, [wallets]);

  const handleGetSubAccounts = async () => {
    if (!baseAccount) return;

    setIsLoading(true);
    try {
      // Переключаемся на Base Sepolia (или Base Mainnet - используйте 8453 для mainnet)
      await baseAccount.switchChain(84532);
      const provider = await baseAccount.getEthereumProvider();

      // Получаем существующие субаккаунты
      const response = await provider.request({
        method: 'wallet_getSubAccounts',
        params: [{
          account: baseAccount.address,
          domain: window.location.origin
        }]
      });

      const { subAccounts: existingSubAccounts } = response;
      setSubAccounts(existingSubAccounts || []);
    } catch (error) {
      console.error("Error getting Sub Accounts:", error);
    } finally {
      setIsLoading(false);
    }
  };

  const handleAddSubAccount = async () => {
    if (!baseAccount) return;

    setIsLoading(true);
    try {
      // Переключаемся на Base Sepolia (или Base Mainnet - используйте 8453 для mainnet)
      await baseAccount.switchChain(84532);
      const provider = await baseAccount.getEthereumProvider();

      // Создаем новый субаккаунт
      await provider.request({
        method: 'wallet_addSubAccount',
        params: [{
          version: '1',
          account: {
            type: 'create',
            keys: [{
              type: 'address',
              publicKey: baseAccount.address
            }]
          }
        }]
      });

      // Обновляем список субаккаунтов
      await handleGetSubAccounts();
    } catch (error) {
      console.error("Error creating Sub Account:", error);
    } finally {
      setIsLoading(false);
    }
  };

  return (
    <div className="space-y-4">
      <div className="flex gap-4">
        <button 
          onClick={handleGetSubAccounts}
          disabled={!baseAccount || isLoading}
          className="px-4 py-2 bg-blue-600 text-white rounded disabled:opacity-50"
        >
          Получить субаккаунты
        </button>
        <button 
          onClick={handleAddSubAccount}
          disabled={!baseAccount || isLoading}
          className="px-4 py-2 bg-green-600 text-white rounded disabled:opacity-50"
        >
          Создать субаккаунт
        </button>
      </div>

      {subAccounts.length > 0 && (
        <div>
          <h4 className="font-medium mb-2">Existing Sub Accounts:</h4>
          <div className="space-y-2">
            {subAccounts.map((subAccount, index) => (
              <div key={index} className="p-3 border rounded-md">
                <p><strong>Address:</strong> {subAccount.address}</p>
                <p><strong>Factory:</strong> {subAccount.factory}</p>
                <p><strong>Factory Data:</strong> {subAccount.factoryData}</p>
              </div>
            ))}
          </div>
        </div>
      )}
    </div>
  );
};
```
</CodeGroup>

### Ключевые методы

#### Получение субаккаунтов

Используйте `wallet_getSubAccounts` для получения существующих субаккаунтов для домена:

```tsx Get Sub Accounts (components/sections/sub-accounts.tsx)
const response = await provider.request({
  method: 'wallet_getSubAccounts',
  params: [{
    account: baseAccount.address,
    domain: window.location.origin
  }]
});
```

#### Создание субаккаунтов

Используйте `wallet_addSubAccount` для создания новых субаккаунтов:

```tsx Create Sub Account (components/sections/sub-accounts.tsx)
await provider.request({
  method: 'wallet_addSubAccount',
  params: [{
    version: '1',
    account: {
      type: 'create',
      keys: [{
        type: 'address',
        publicKey: baseAccount.address
      }]
    }
  }]
});
```

### Конфигурация сети

Субаккаунты работают как в основной сети Base, так и в тестовой сети Base Sepolia:

- **Base Mainnet**: Chain ID `8453`
- **Base Sepolia**: Chain ID `84532`

### Узнать больше

- [Руководство по субаккаунтам](/base-account/improve-ux/sub-accounts)
- [Рецепт субаккаунтов Privy](https://docs.privy.io/recipes/react/external-wallets/base-sub-accounts)
