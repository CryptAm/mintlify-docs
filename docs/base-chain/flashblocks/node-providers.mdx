---
title: Как размещать RPC-узлы с поддержкой Flashblocks
sidebarTitle: Провайдеры узлов
---

## Быстрый старт

1. **Предварительные требования:**:
  - Docker и Docker Compose
  - Минимальные аппаратные требования (смотреть [node README](https://github.com/base/node?tab=readme-ov-file#hardware-requirements))
  - Доступ к конечной точке WebSocket Flashblocks, мы предоставляем публичные конечные точки в файлах `env` в репозитории

2. **Настройка окружения**:

  ```sh
  # Клонируйте репозиторий
  git clone https://github.com/base/node.git
  cd node
  ```

3. **Запустите узел с поддержкой Flashblocks**:

  ```sh
  NODE_TYPE=base CLIENT=reth RETH_FB_WEBSOCKET_URL="wss://mainnet.flashblocks.base.org/ws" docker-compose up
  ```

## Параметры конфигурации

- Тип узла: Используйте `NODE_TYPE=base` для включения базового узла `reth` с функциональностью Flashblocks
- Сеть: Используйте `NETWORK_ENV=.env.mainnet` для mainnet или `NETWORK_ENV=.env.sepolia` для testnet

Убедитесь, что установлена переменная `RETH_FB_WEBSOCKET_URL`. Base предлагает следующие публичные RPC с ограничением скорости:
- Для Mainnet: `RETH_FB_WEBSOCKET_URL=wss://mainnet.flashblocks.base.org/ws`
- Для Sepolia: `RETH_FB_WEBSOCKET_URL=wss://sepolia.flashblocks.base.org/ws`

## Проверка функциональности Flashblocks

Протестируйте, что ваш узел правильно поддерживает Flashblocks, запросив ожидающий блок:

```sh
curl -X POST \
  --data '{"jsonrpc":"2.0","method":"eth_getBlockByNumber","params":["pending", false],"id":1}' \
  http://localhost:8545
```

## Доступные методы RPC

Узлы с поддержкой Flashblocks предоставляют все стандартные методы Ethereum JSON-RPC плюс специализированные конечные точки Flashblocks. Для получения более подробной информации смотреть [Flashblocks RPC API documentation](/base-chain/flashblocks/apps#rpc-api).


## WebSocket API

WebSocket API предназначен для потоковой передачи данных Flashblock узлам, чтобы они могли предоставлять их через свои RPC API. Конечные точки доступны по адресам:

   | Сеть               | URL                                   |
   | :----------------- | :------------------------------------ |
   | Mainnet            | wss://mainnet.flashblocks.base.org/ws |
   | Sepolia            | wss://sepolia.flashblocks.base.org/ws |


#### Интерпретация данных

Чтобы минимизировать объём данных, отправляемых нодам, каждый Flashblock содержит только данные изменений (diff) относительно предыдущего блока.
Начальный Flashblock (когда индекс равен нулю) включает полные свойства блока (например, номер, лимит газа), а все последующие Flashblocks содержат только данные diff - например, транзакции, которые присутствуют именно в этом Flashblock.

**Пример начального ответа**
```
{
  "payload_id": "0x03997352d799c31a",
  "index": 0,
  "base": {
    "parent_hash": "0x9edc29b8b0a1e31d28616e40c16132ad0d58faa8bb952595b557526bdb9a960a",
    "fee_recipient": "0x4200000000000000000000000000000000000011",
    "block_number": "0x158a0e9",
    "gas_limit": "0x3938700",
    "timestamp": "0x67bf8332",
    "base_fee_per_gas": "0xfa"
    // ... другие базрвые поля ...
  },
  "diff": {
    "state_root": "0x208fd63edc0681161105f27d03daf9f8c726d8c94e584a3c0696c98291c24333",
    "block_hash": "0x5c330e55a190f82ea486b61e5b12e27dfb4fb3cecfc5746886ef38ca1281bce8",
    "gas_used": "0xab3f",
    "transactions": [
      "0x7ef8f8a0b4afc0b7ce10e150801bbaf08ac33fecb0f38311793abccb022120d321c6d276..."
    ],
    "withdrawals": []
    // ... другие различные поля ...
  },
  "metadata": {
    "block_number": 22585577,
    "new_account_balances": {
      "0x000f3df6d732807ef1319fb7b8bb8522d0beac02": "0x0",
      // ... другие балансы ...
    },
    "receipts": {
      "0x07d7f06b06fea714c1d1d446efa2790c6970aa74ee006186a32b5b7dd8ca2d82": {
        "Deposit": {
          "status": "0x1",
          "depositNonce": "0x158a0ea"
          // ... другие поля квитанции ...
        }
      }
    }
  }
}
```

**Пример ответа с различиями**
```
{
  "payload_id": "0x03e303378749418d",
  "index": 4,
  "diff": {
    "state_root": "0x7a8f45038665072f382730e689f4a1561835c9987fca8942fa95872fb9367eaa",
    "block_hash": "0x9b32f7a14cbd1efc8c2c5cad5eb718ec9e0c5da92c3ba7080f8d4c49d660c332",
    "gas_used": "0x1234f",
    "transactions": [
      "0x7ef8f8a0b4afc0b7ce10e150801bbaf08ac33fecb0f38311793abccb022120d321c6d276..."
    ],
    "withdrawals": []
    // ... другие различные поля ...
  },
  "metadata": {
    "block_number": 22585577,
    "new_account_balances": {
      "0x000f3df6d732807ef1319fb7b8bb8522d0beac02": "0x0",
      "0x4200000000000000000000000000000000000015": "0x1234"
      // ... другие балансы ...
    },
    "receipts": {
      "0x07d7f06b06fea714c1d1d446efa2790c6970aa74ee006186a32b5b7dd8ca2d82": {
        "status": "0x1",
        "gasUsed": "0x1234f",
        "logs": []
        // ... другие поля квитанции ...
      }
    }
  }
}
```

## Дополнительные ресурсы

Для получения подробной информации о настройке узла, включая аппаратные требования и дополнительные параметры конфигурации, обратитесь к [Reth node README](https://github.com/base/node/tree/main/reth#readme).

