---
title: Финализация транзакций
description: Подробная информация о финализации транзакций на Base.
---

## Что такое финализация транзакций?

Финализация - это момент, после которого отправленная транзакция в Base становится необратимой. Это гарантирует, что транзакция не будет откатана или потеряна.

Финализация работает по-разному для обычных транзакций, которые изменяют состояние L2 Base, и для транзакций, которые выводят средства из Base L2 в Ethereum L1.

<Note>
**Только транзакции, которые выводят средства из Base в Ethereum, должны ждать 7 дней.** Обычные транзакции внутри Base, такие как свапы или переводы, _не_ должны ждать 7 дней.
</Note>


## Финализация для L2-транзакций в Base
Этот раздел описывает финализацию всех транзакций в Base, кроме выводов средств в Ethereum L1.

Для транзакций в Base нет одной фиксированной задержки. Вместо этого существует 4 этапа финализации, каждый из которых даёт всё более сильные гарантии безопасности.

![Diagram of transaction finality stages on Base](/images/transaction-finality/base-tx-finality.jpg)

<Steps>
<Step title="Включение во Flashblock: ~200 мс" titleSize="h3">
Через ~200 мс транзакция включается в блок предварительного подтверждения (Flashblock) секвенсором Base.
<Accordion title="Менее 0.001% вероятности реорганизации.">
* Flashblock'и откатываются реже чем в 0.001% случаев.
* Историю реорганизаций можно увидеть на нашей [публичной странице статистики.](https://base.org/stats)
</Accordion>

</Step>
<Step title="Включение в L2-блок: ~2 сек" titleSize="h3">
Через ~2 секунды секвенсор строит L2-блок и распространяет его среди валидаторов.
<Accordion title="Near 0% probability of a reorg.">
* За всё время откатился только один L2-блок Base - это 0.0000003% транзакций. Данные можно увидеть [здесь](https://base.blockscout.com/blocks?tab=reorgs)
</Accordion>
</Step>

<Step title="Публикация батча в L1: ~2 мин" titleSize="h3">
Через ~2 минуты батч Base, содержащий транзакцию, публикуется в Ethereum.
<Accordion title="Практически 0% вероятности реорганизации.">
* Никогда не было отката L2-блоков, уже отправленных в Ethereum L1.
* **Реорганизация Ethereum L1 не вызывает реорганизацию Base L2.** Секвенсор и валидаторы Base работают с регулируемой задержкой от вершины L1, поэтому обычные реорги L1 не влияют на L2. При крупных реоргах Ethereum Base может повторно отправить батч, не меняя последовательность L2-блоков.
</Accordion>

</Step>
<Step title="Финализация батча в L1: ~20 мин" titleSize="h3">
Батч Ethereum L1, содержащий транзакцию, становится старше 2 эпох (64 блоков).
<Accordion title="Практически 0% вероятности реорганизации.">
* L2-блоки, достигшие финализации L1 батча, защищены так же, как и финализированные блоки Ethereum. Их невозможно откатить на практике.
</Accordion>
</Step>
</Steps>

## Финализация транзакций вывода средств
Эта часть описывает финализацию транзакций, которые переводят средства из Base в Ethereum.

**Только выводы средств в Ethereum должны ждать 7 дней, прежде чем средства будут доступны на адресе в Ethereum L1** Это нужно для системы Fault Proof, обеспечивающей очень высокую степень безопасности для средств, отправленных в Base.

<Accordion title="Что происходит в течение 7 дней?">
Когда начинается вывод средств из Base в Ethereum, средства списываются с баланса в Base. Позже любой «пропозера» должен предоставить Ethereum доказательство того, что вывод действительно существует в Base.

Но Ethereum сам по себе не может проверить, что произошло в Base, так как это разные блокчейны. Поэтому существует 7-дневное окно, в течение которого любой «челленджер» может оспорить предложение, если считает его вредоносным. Если в течение 7 дней возражений не поступит, вывод может быть доказан относительно финализированного корня выходных данных и высвобожден получателю в L1. Но если возражение подано, пропозер и челленджер вступают в так называемую Fault Dispute Game. Эта игра требует внесения увеличивающихся залогов, и в конечном итоге определяется победитель. Если побеждает пропозер, корень выходных данных финализируется и может использоваться для подтверждения выводов (с их высвобождением в L1). Если побеждает челленджер, предложение выходных данных становится недействительным.
Эта система требует наличия всего одной честной стороны для обеспечения безопасности. Base всегда будет запускать честного "пропозера" и "челленджера".

Примечание: если "челленджер" выигрывает спор, состояние L2 не откатывается. Неверным становится только предложенный output root, и любые выводы, доказанные через него, не могут финализироваться. Такие выводы нужно доказывать заново через другой, валидный output root.
</Accordion>

## Часто задаваемые вопросы

<AccordionGroup>
  <Accordion title="Если в Ethereum будет реорг, вызовет ли он реорг в Base?">
В большинстве случаев - нет. Base может просто повторно отправить данные батча в Ethereum, пока L2 продолжает нормальную работу.
  </Accordion>

  <Accordion title="Как долго финализируются депозиты?">
Транзакции, перемещающие средства из Ethereum L1 в Base, должны быть включены в блок L1 и обычно обрабатываются секвенсором Base в течение ~3 минут.
  </Accordion>

  <Accordion title="Если "челленджер" выигрывает спор, будет ли реорг цепи L2?">
Нет. Оспариваемое предложение output root помечается как недействительное, и любые действия, использующие его, также становятся недействительными. В частности, выводы из Base в L1, доказанные против этого output root, должны быть доказаны заново против другого, валидного корня. 
  </Accordion>
</AccordionGroup>
