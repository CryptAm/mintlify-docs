---
title: Производительность узла
sidebarTitle: Оптимизация производительности
---

Это руководство предоставляет рекомендации по оборудованию, клиентскому программному обеспечению и настройкам конфигурации для оптимизации производительности вашего узла Base.

## Оборудование

Для работы производительного узла Base требуется соответствующее оборудование. Мы рекомендуем следующие минимальные спецификации:

1. Современный многоядерный процессор с хорошей одноядерной производительностью.
2. Не менее 32 ГБ ОЗУ (рекомендуется 64 GB).  
3. Локально подключенный NVMe SSD диск. Конфигурации RAID 0 могут улучшить производительность. 
4. Достаточный объем памяти, рассчитываемый как:

  ```
  (2 \* [current chain size](https://base.org/stats) + [snapshot size](https://basechaindata.vercel.app) + 20% buffer)
  ```

  Это учитывает рост данных цепи и пространство для восстановления из снепшота.

<Note>
При использовании Amazon Elastic Block Store (EBS) рекомендуются тома io2 Block Express для обеспечения достаточной скорости чтения с диска и предотвращения проблем с задержками во время начальной синхронизации. Однако **локально подключенные NVMe SSD настоятельно рекомендуются вместо сетевого хранилища для оптимальной производительности.**
</Note>

### Примеры оборудования для производства

Ниже приведены спецификации оборудования, используемого для производственных узлов Base:

- **Архивный узел Reth (рекомендуется):**
    - Экземпляр: AWS `i7i.12xlarge` or larger 
    - Хранилище: RAID 0 of all local NVMe drives (`/dev/nvme*`)  
    - Файловая система: ext4  

- **Полный узел Geth:**
    - Экземпляр: AWS `i7i.12xlarge` or larger
    - Хранилище: RAID 0 of all local NVMe drives (`/dev/nvme*`)  
    - Файловая система: ext4  

## Начальная синхронизация

Использование недавнего [снепшота](/base-chain/node-operators/snapshots) может значительно сократить время, необходимое для процесса начальной синхронизации узла.

## Клиентское программное обеспечение

Репозиторий [Base Node](https://github.com/base/node) содержит текущие стабильные конфигурации и инструкции для запуска различных клиентских реализаций.

Reth в настоящее время является наиболее производительным клиентом для запуска узлов Base. Будущие оптимизации будут в основном сосредоточены на Reth. Подробнее о переходе на Reth можно прочитать [здесь](https://blog.base.dev/scaling-base-with-reth).

### Настройка производительности Geth (устарело)

<Warning>
Geth больше не поддерживается, и Reth является рекомендуемым клиентом, который показал себя более производительным. Мы рекомендуем мигрировать узлы Geth на Reth, особенно если вы испытываете проблемы с производительностью.
</Warning>

#### Настройки кэша Geth

Для узлов Geth настройка распределения кэша через переменные окружения может улучшить производительность. Эти настройки используются в стандартной конфигурации Docker:

```bash
# .env.mainnet / .env.sepolia
GETH_CACHE="20480"             # Общий объем памяти для кэша P2P (MB) (по умолчанию: 1024)
GETH_CACHE_DATABASE="20"       # Процент памяти кэша для операций ввода-вывода базы данных (по умолчанию: 75)
GETH_CACHE_GC="12"             # Процент памяти кэша для сборки мусора (по умолчанию: 25)
GETH_CACHE_SNAPSHOT="24"       # Процент памяти кэша для кэширования снепшотов (по умолчанию: 10)
GETH_CACHE_TRIE="44"           # Процент памяти кэша для кэширования trie (по умолчанию: 25)
```

#### Настройка LevelDB для Geth

Для команд, запускающих Geth с LevelDB, следующий патч позволяет устанавливать параметры инициализации LevelDB через переменные окружения:

[https://github.com/0x00101010/goleveldb/commit/55ef3429673fb70d389d052a15a4423e13d8b43c](https://github.com/0x00101010/goleveldb/commit/55ef3429673fb70d389d052a15a4423e13d8b43c)

Этот патч можно применить с помощью директивы `replace` в `go.mod` при сборке `op-geth`. Вот как изменить ваш Dockerfile:

```dockerfile
RUN git clone $REPO --branch $VERSION --single-branch . && \
    git switch -c branch-$VERSION $COMMIT && \
    bash -c '[ "$(git rev-parse HEAD)" = "$COMMIT" ]'

RUN echo '' >> go.mod && \
    echo 'replace github.com/syndtr/goleveldb => github.com/0x00101010/goleveldb v1.0.4-param-customization' >> go.mod && \
    go mod tidy

# Продолжаем сборку op-geth
COPY op-geth/ ./
RUN go run build/ci.go install -static ./cmd/geth
```

Рекомендуемые значения переменных окружения LevelDB с этим патчем:

```bash
# Рекомендуемые настройки LevelDB
LDB_BLOCK_SIZE="524288"              # Размер блока 512 КiB (совпадает с размерами чанков RAID 0)
LDB_COMPACTION_TABLE_SIZE="8388608"  # Размер таблицы компактификации 8 MiB (по умолчанию: 2 MiB)
LDB_COMPACTION_TOTAL_SIZE="41943040" # Общий размер компактификации 40 MiB (по умолчанию: 8 MiB)
LDB_DEBUG_OPTIONS="1"                # Включить логи отладки LevelDB
```

